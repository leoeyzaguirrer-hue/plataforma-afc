<!DOCTYPE html>
<html lang="es" data-theme="light">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>MÃ³dulo 4 â€” Condicionamiento ClÃ¡sico Â· AFC Praxis</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400&family=Space+Mono:wght@400;700&family=Fraunces:ital,opsz,wght@0,9..144,300;0,9..144,600;0,9..144,700;1,9..144,400&display=swap" rel="stylesheet">
<style>
:root,[data-theme="light"]{--bg:#f0f4f8;--bg2:#f7f9fc;--card:#fff;--card2:#f4f7fa;--text:#334155;--dim:#64748b;--bright:#0f172a;--muted:#94a3b8;--accent:#0891b2;--accent-b:#22d3ee;--accent-g:rgba(8,145,178,0.06);--accent-l:#cffafe;--gold:#d97706;--gold-b:#f59e0b;--gold-g:rgba(217,119,6,0.06);--green:#059669;--green-b:#10b981;--green-g:rgba(5,150,105,0.06);--red:#dc2626;--red-b:#ef4444;--red-g:rgba(220,38,38,0.05);--purple:#7c3aed;--purple-g:rgba(124,58,237,0.05);--border:rgba(15,23,42,0.08);--border2:rgba(15,23,42,0.04);--shadow:0 2px 8px rgba(0,0,0,0.06);--shadow-lg:0 8px 30px rgba(0,0,0,0.08);--overlay:rgba(255,255,255,0.92);--r:14px;--rs:10px}
[data-theme="dark"]{--bg:#0f172a;--bg2:#1e293b;--card:#1e293b;--card2:#334155;--text:#cbd5e1;--dim:#94a3b8;--bright:#f1f5f9;--muted:#64748b;--accent:#22d3ee;--accent-b:#67e8f9;--accent-g:rgba(34,211,238,0.1);--accent-l:#164e63;--gold:#fbbf24;--gold-b:#fcd34d;--gold-g:rgba(251,191,36,0.08);--green:#34d399;--green-b:#6ee7b7;--green-g:rgba(52,211,153,0.08);--red:#f87171;--red-b:#fca5a5;--red-g:rgba(248,113,113,0.08);--purple:#a78bfa;--purple-g:rgba(167,139,250,0.08);--border:rgba(148,163,184,0.12);--border2:rgba(148,163,184,0.06);--shadow:0 2px 8px rgba(0,0,0,0.2);--shadow-lg:0 8px 30px rgba(0,0,0,0.3);--overlay:rgba(15,23,42,0.95);--r:14px;--rs:10px}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}:focus-visible{outline:2px solid var(--accent);outline-offset:2px;border-radius:4px}html,body{height:100%;overflow:hidden;background:var(--bg);color:var(--text);font-family:'DM Sans',system-ui,sans-serif;font-size:18px;line-height:1.65;transition:background .3s,color .3s}.app{position:fixed;inset:0;display:flex;flex-direction:column;z-index:1}
.top{display:flex;align-items:center;gap:10px;padding:10px 16px;height:56px;background:var(--overlay);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border-bottom:1px solid var(--border);flex-shrink:0;z-index:20}.top-back{width:38px;height:38px;border-radius:10px;background:var(--bg);border:1px solid var(--border);color:var(--accent);display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .15s;flex-shrink:0}.top-back:hover{background:var(--accent-g);border-color:var(--accent)}.top-back svg{width:18px;height:18px;stroke:currentColor;fill:none;stroke-width:2.5;stroke-linecap:round;stroke-linejoin:round}.top-t{font-family:'Fraunces',serif;font-size:16px;font-weight:600;color:var(--bright);line-height:1.2}.top-s{font-size:12px;color:var(--dim)}.top-prog{margin-left:auto;display:flex;align-items:center;gap:6px;flex-shrink:0}.top-prog-bar{width:52px;height:5px;border-radius:3px;background:var(--border);overflow:hidden}.top-prog-fill{height:100%;background:var(--accent);border-radius:3px;transition:width .4s}.top-prog-pct{font-family:'Space Mono',monospace;font-size:11px;color:var(--dim)}.top-acts{display:flex;gap:4px;flex-shrink:0}.top-btn{width:36px;height:36px;border-radius:8px;background:transparent;border:1px solid var(--border);color:var(--dim);display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .15s}.top-btn:hover{color:var(--accent);border-color:var(--accent);background:var(--accent-g)}.top-btn svg{width:16px;height:16px;stroke:currentColor;fill:none;stroke-width:2}
.cnt{flex:1;overflow-y:auto;overflow-x:hidden;padding:20px 16px 110px;-webkit-overflow-scrolling:touch}.cnt::-webkit-scrollbar{width:3px}.cnt::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}.bot{position:fixed;bottom:0;left:0;right:0;padding:10px 16px;padding-bottom:max(10px,env(safe-area-inset-bottom));background:var(--overlay);backdrop-filter:blur(12px);border-top:1px solid var(--border2);z-index:20;display:flex;gap:8px}
.btn{flex:1;padding:14px 20px;border-radius:var(--rs);font-family:'DM Sans',sans-serif;font-size:16px;font-weight:600;border:none;cursor:pointer;transition:all .15s;text-align:center;display:inline-flex;align-items:center;justify-content:center;gap:6px}.btn:active{transform:scale(0.97)}.btn-p{background:var(--accent);color:#fff;box-shadow:0 2px 10px rgba(8,145,178,0.2)}.btn-p:disabled{opacity:.35;pointer-events:none}.btn-g{background:var(--green);color:#fff}.btn-o{background:var(--card);color:var(--text);border:1px solid var(--border);flex:none}.btn-w{background:var(--gold);color:#fff}.btn-sm{flex:none;padding:10px 16px;font-size:14px}.btn-icon{flex:none;width:44px;padding:0}
.card{background:var(--card);border:1px solid var(--border);border-radius:var(--r);padding:22px;margin-bottom:14px;box-shadow:var(--shadow)}.tag{font-family:'Space Mono',monospace;font-size:11px;text-transform:uppercase;letter-spacing:1px;display:inline-flex;align-items:center;gap:5px;padding:4px 10px;border-radius:6px;margin-bottom:10px}.tag-b{color:var(--accent);background:var(--accent-g)}.tag-g{color:var(--gold);background:var(--gold-g)}.tag-gr{color:var(--green);background:var(--green-g)}.tag-p{color:var(--purple);background:var(--purple-g)}.card-t{font-family:'Fraunces',serif;font-size:22px;font-weight:700;color:var(--bright);line-height:1.3;margin-bottom:6px}.card-d{font-size:16px;color:var(--dim);line-height:1.6}
.prose{font-size:16px;color:var(--text);line-height:1.75}.prose p{margin-bottom:10px}.prose b,.prose strong{color:var(--bright)}.callout{background:var(--accent-g);border-left:3px solid var(--accent);padding:14px 16px;border-radius:0 var(--rs) var(--rs) 0;margin:12px 0;font-size:15px;color:var(--bright);line-height:1.65}.callout em{color:var(--accent);font-style:normal;font-weight:600}.callout-g{background:var(--gold-g);border-color:var(--gold)}.callout-g em{color:var(--gold)}.callout-r{background:var(--red-g);border-color:var(--red)}.callout-r em{color:var(--red)}.ex-box{background:var(--bg2);border:1px solid var(--border);border-radius:var(--rs);padding:14px 16px;margin:12px 0}.ex-box-l{font-size:11px;font-weight:700;color:var(--accent);text-transform:uppercase;letter-spacing:.8px;margin-bottom:4px}.ex-box p{font-size:15px;color:var(--text);margin:0;line-height:1.6}
.diag{background:var(--bg2);border:1.5px solid var(--border);border-radius:var(--r);padding:18px;margin:14px 0;text-align:center;font-size:15px;line-height:2.2;color:var(--bright);font-weight:500}.diag .arrow{color:var(--accent);font-weight:700;margin:0 4px}.diag .label{font-family:'Space Mono',monospace;font-size:11px;color:var(--dim);display:block;margin-top:6px;text-transform:uppercase;letter-spacing:1px}.diag .phase{padding:6px 12px;border-radius:8px;display:inline-block;margin:4px 0}.diag .ph-before{background:var(--accent-g);color:var(--accent)}.diag .ph-during{background:var(--gold-g);color:var(--gold)}.diag .ph-after{background:var(--green-g);color:var(--green)}
.acc{border:1px solid var(--border);border-radius:var(--rs);margin-bottom:8px;overflow:hidden;background:var(--card)}.acc-h{display:flex;align-items:center;gap:10px;padding:14px 16px;cursor:pointer;user-select:none}.acc-i{width:30px;height:30px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:16px;flex-shrink:0}.acc-l{font-weight:600;font-size:16px;color:var(--bright);flex:1}.acc-a{font-size:10px;color:var(--muted);transition:transform .3s}.acc.open .acc-a{transform:rotate(180deg)}.acc-b{max-height:0;overflow:hidden;transition:max-height .4s ease}.acc.open .acc-b{max-height:3000px}.acc-in{padding:0 16px 16px}
.tp-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.3);z-index:25;display:none}.tp-overlay.open{display:block}.tp{position:fixed;top:56px;right:0;bottom:0;width:88%;max-width:420px;background:var(--card);border-left:1px solid var(--border);z-index:30;overflow-y:auto;padding:20px;box-shadow:-4px 0 20px rgba(0,0,0,0.1);display:none}.tp.open{display:block}.tp-close{position:absolute;top:12px;right:12px;cursor:pointer;font-size:22px;color:var(--dim);background:none;border:none}
.lcard{display:flex;align-items:center;gap:14px;background:var(--card);border:1.5px solid var(--border);border-radius:var(--r);padding:16px 18px;margin-bottom:10px;cursor:pointer;transition:all .2s;box-shadow:var(--shadow)}.lcard:hover:not(.locked){border-color:rgba(8,145,178,0.2);box-shadow:var(--shadow-lg)}.lcard:active:not(.locked){transform:scale(0.98)}.lcard.locked{opacity:.35;pointer-events:none}.lcard.done{border-color:rgba(5,150,105,0.2)}.lcard-icon{width:50px;height:50px;border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:24px;flex-shrink:0}.lcard.done .lcard-icon{background:var(--green-g)!important}.lcard-name{font-weight:600;font-size:16px;color:var(--bright);margin-bottom:2px}.lcard-sub{font-size:13px;color:var(--dim)}.lcard-arrow{color:var(--muted);margin-left:auto;font-size:20px}.lbar{width:100%;height:4px;border-radius:2px;background:var(--border);margin-top:6px;overflow:hidden}.lbar-f{height:100%;border-radius:2px;transition:width .4s}
.pips{display:flex;align-items:center;gap:3px;justify-content:center;margin-bottom:16px;flex-wrap:wrap}.pip{width:18px;height:5px;border-radius:3px;background:var(--border);transition:all .3s}.pip.ok{background:var(--green)}.pip.fail{background:var(--red)}.pip.cur{background:var(--accent);width:26px}
.streak{display:inline-flex;align-items:center;gap:3px;font-family:'Space Mono',monospace;font-size:13px;font-weight:700;color:var(--gold);background:var(--gold-g);padding:4px 10px;border-radius:6px;margin-left:8px;animation:streakPop .3s ease}.streak.hide{display:none}@keyframes streakPop{from{transform:scale(0.7);opacity:0}to{transform:scale(1);opacity:1}}
.q-h{display:flex;align-items:center;gap:8px;margin-bottom:8px}.q-type{font-size:22px}.q-tag{font-family:'Space Mono',monospace;font-size:10px;text-transform:uppercase;letter-spacing:1px;color:var(--accent);padding:3px 8px;background:var(--accent-g);border-radius:4px}.q-n{font-family:'Space Mono',monospace;font-size:11px;color:var(--muted);margin-left:auto}.q-text{font-size:18px;font-weight:500;color:var(--bright);margin-bottom:16px;line-height:1.55}.q-ctx{font-size:15px;color:var(--dim);font-style:italic;margin-bottom:14px;padding:12px 14px;background:var(--bg2);border-radius:var(--rs);border-left:3px solid var(--border)}
.opt{display:flex;align-items:flex-start;gap:12px;padding:14px 16px;border:1.5px solid var(--border);border-radius:var(--rs);margin-bottom:7px;cursor:pointer;transition:all .2s;user-select:none}.opt:active{transform:scale(0.98)}.opt:hover:not(.dis){background:var(--bg2)}.opt.pick{border-color:var(--accent);background:var(--accent-g)}.opt.ok{border-color:var(--green);background:var(--green-g)}.opt.bad{border-color:var(--red);background:var(--red-g)}.opt.rev{border-color:var(--green);background:var(--green-g);opacity:.5}.opt.dis{pointer-events:none}.opt-m{width:24px;height:24px;border-radius:50%;border:2px solid var(--border);display:flex;align-items:center;justify-content:center;flex-shrink:0;font-size:12px;font-weight:700;color:var(--muted);transition:all .2s}.opt.pick .opt-m{border-color:var(--accent);color:var(--accent);background:var(--accent-g)}.opt.ok .opt-m{border-color:var(--green);color:#fff;background:var(--green)}.opt.bad .opt-m{border-color:var(--red);color:#fff;background:var(--red)}.opt-t{font-size:16px;color:var(--text);line-height:1.5;flex:1}
.tf{display:flex;gap:10px;margin-bottom:8px}.tf-b{flex:1;padding:18px;border:2px solid var(--border);border-radius:var(--rs);font-size:18px;font-weight:600;text-align:center;cursor:pointer;transition:all .15s;background:var(--card);color:var(--text)}.tf-b:active{transform:scale(0.97)}.tf-b:hover:not(.dis){border-color:var(--accent);background:var(--accent-g)}.tf-b.ok{border-color:var(--green);background:var(--green-g);color:var(--green)}.tf-b.bad{border-color:var(--red);background:var(--red-g);color:var(--red)}.tf-b.dis{pointer-events:none}
.cl-cats{display:flex;gap:8px;flex-wrap:wrap}.cl-c{padding:10px 18px;border-radius:8px;font-size:15px;font-weight:500;border:1.5px solid var(--border);background:var(--card);color:var(--text);cursor:pointer;transition:all .15s}.cl-c:active{transform:scale(0.96)}.cl-c.ok{border-color:var(--green);background:var(--green-g);color:var(--green)}.cl-c.bad{border-color:var(--red);background:var(--red-g);color:var(--red)}.cl-c.dis{pointer-events:none}
.mat-w{display:flex;gap:12px;align-items:flex-start;margin-bottom:12px}.mat-c{flex:1;display:flex;flex-direction:column;gap:6px}.mat-i{padding:12px;border-radius:var(--rs);font-size:14px;border:1.5px solid var(--border);background:var(--card);color:var(--text);cursor:pointer;transition:all .15s;text-align:center}.mat-i:hover:not(.dis){border-color:var(--accent)}.mat-i.sel{border-color:var(--accent);background:var(--accent-g);color:var(--accent)}.mat-i.ok{border-color:var(--green);background:var(--green-g);color:var(--green)}.mat-i.bad{border-color:var(--red);background:var(--red-g);color:var(--red)}.mat-i.dis{pointer-events:none}
.ord-bank{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:12px}.ord-item{padding:10px 16px;border:1.5px solid var(--border);border-radius:var(--rs);font-size:15px;background:var(--card);color:var(--text);cursor:pointer;transition:all .2s;user-select:none}.ord-item:hover:not(.dis){border-color:var(--accent);background:var(--accent-g)}.ord-item:active:not(.dis){transform:scale(0.95)}.ord-item.placed{opacity:.3;pointer-events:none}.ord-item.dis{pointer-events:none}.ord-seq{display:flex;flex-direction:column;gap:6px;min-height:48px;margin-bottom:8px}.ord-slot{display:flex;align-items:center;gap:10px;padding:10px 14px;border-radius:var(--rs);background:var(--bg2);border:1.5px dashed var(--border);font-size:15px;color:var(--bright);transition:all .2s}.ord-slot .ord-num{width:28px;height:28px;border-radius:50%;background:var(--accent);color:#fff;display:flex;align-items:center;justify-content:center;font-family:'Space Mono',monospace;font-size:13px;font-weight:700;flex-shrink:0}.ord-slot.ok{border-color:var(--green);border-style:solid;background:var(--green-g)}.ord-slot.ok .ord-num{background:var(--green)}.ord-slot.bad{border-color:var(--red);border-style:solid;background:var(--red-g)}.ord-slot.bad .ord-num{background:var(--red)}
.fill-diag{background:var(--bg2);border:1.5px solid var(--border);border-radius:var(--r);padding:20px;margin-bottom:14px;text-align:center;font-size:16px;line-height:2.4;color:var(--bright)}.fill-blank{display:inline-flex;align-items:center;justify-content:center;min-width:120px;height:36px;border:2px dashed var(--accent);border-radius:8px;background:var(--card);color:var(--accent);font-weight:600;font-size:14px;margin:2px 4px;padding:0 10px;cursor:pointer;transition:all .2s;vertical-align:middle}.fill-blank.filled{border-style:solid;background:var(--accent-g)}.fill-blank.ok{border-color:var(--green);background:var(--green-g);color:var(--green)}.fill-blank.bad{border-color:var(--red);background:var(--red-g);color:var(--red)}.fill-bank{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;margin-top:10px}.fill-opt{padding:8px 16px;border:1.5px solid var(--border);border-radius:8px;font-size:14px;font-weight:500;background:var(--card);color:var(--text);cursor:pointer;transition:all .15s}.fill-opt:hover:not(.dis):not(.used){border-color:var(--accent);background:var(--accent-g)}.fill-opt.used{opacity:.3;pointer-events:none}.fill-opt.dis{pointer-events:none}
.pat{background:var(--card);border:1.5px solid rgba(217,119,6,0.15);border-radius:var(--r);padding:18px;margin-bottom:14px;box-shadow:0 2px 10px rgba(217,119,6,0.04)}.pat-h{display:flex;align-items:center;gap:12px;margin-bottom:12px}.pat-av{width:48px;height:48px;border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:20px;font-weight:700;color:#fff;flex-shrink:0}.pat-av.f{background:linear-gradient(135deg,#db2777,#f472b6)}.pat-av.m{background:linear-gradient(135deg,#2563eb,#60a5fa)}.pat-av.c{background:linear-gradient(135deg,#d97706,#fbbf24)}.pat-name{font-family:'Fraunces',serif;font-size:18px;font-weight:700;color:var(--bright)}.pat-age{font-size:12px;color:var(--dim)}.pat-badge{font-family:'Space Mono',monospace;font-size:9px;text-transform:uppercase;letter-spacing:.8px;padding:3px 8px;border-radius:4px;background:var(--gold-g);color:var(--gold);border:1px solid rgba(217,119,6,0.12);margin-left:auto}.pat-q{font-size:16px;font-style:italic;color:var(--text);line-height:1.65;padding:12px 14px;background:var(--bg2);border-radius:var(--rs);border-left:3px solid var(--gold)}
.fb{padding:14px 16px;border-radius:var(--rs);margin-top:12px;font-size:15px;line-height:1.6;display:none}.fb.show{display:block;animation:fbIn .3s ease}@keyframes fbIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}.fb.fbok{background:var(--green-g);border:1px solid rgba(5,150,105,0.15);color:var(--green)}.fb.fbfail{background:var(--red-g);border:1px solid rgba(220,38,38,0.1);color:var(--red)}[data-theme="dark"] .fb.fbok{color:var(--green-b)}[data-theme="dark"] .fb.fbfail{color:var(--red-b)}.fb strong{display:block;margin-bottom:3px;font-size:14px}.fb-bonus{margin-top:8px;padding:8px 12px;background:var(--accent-g);border-radius:6px;font-size:13px;color:var(--accent)}.fb-rule{margin-top:8px;padding:8px 12px;background:var(--purple-g);border-radius:6px;font-size:13px;color:var(--purple)}
.gate{text-align:center;padding:20px}.gate-ic{font-size:52px;margin-bottom:10px}.gate-t{font-family:'Fraunces',serif;font-size:24px;font-weight:700;color:var(--bright);margin-bottom:6px}.gate-d{font-size:15px;color:var(--dim);margin-bottom:16px;max-width:320px;margin-left:auto;margin-right:auto}.gate-bar{width:200px;height:8px;border-radius:4px;background:var(--border);margin:0 auto 8px;overflow:hidden}.gate-bar-f{height:100%;border-radius:4px}.gate-sc{font-family:'Space Mono',monospace;font-size:15px;font-weight:700;margin-bottom:16px}
.sum-c{width:130px;height:130px;border-radius:50%;border:5px solid var(--border);display:flex;flex-direction:column;align-items:center;justify-content:center;margin:16px auto}.sum-c.great{border-color:var(--green)}.sum-c.mid{border-color:var(--gold)}.sum-c.low{border-color:var(--red)}.sum-n{font-family:'Space Mono',monospace;font-size:40px;font-weight:700;color:var(--bright)}.sum-t{font-size:13px;color:var(--dim)}.sum-msg{text-align:center;font-family:'Fraunces',serif;font-size:22px;font-weight:600;color:var(--bright);margin:10px 0 4px}.sum-sub{text-align:center;font-size:14px;color:var(--dim);margin-bottom:14px}
.sk-grid{display:flex;flex-direction:column;gap:6px;margin:12px 0}.sk-r{display:flex;align-items:center;gap:8px;font-size:14px}.sk-name{flex:1;color:var(--text)}.sk-bar{width:80px;height:5px;border-radius:3px;background:var(--border);overflow:hidden}.sk-bar-f{height:100%;border-radius:3px}.sk-pct{font-family:'Space Mono',monospace;font-size:12px;font-weight:700;width:36px;text-align:right}
.rev{background:var(--red-g);border:1px solid rgba(220,38,38,0.08);border-radius:var(--rs);padding:10px 12px;margin-bottom:6px}.rev-q{font-size:14px;color:var(--bright);margin-bottom:3px}.rev-a{font-size:13px;color:var(--green)}
.cheat{background:var(--card);border:1.5px solid var(--accent);border-radius:var(--r);padding:18px;margin-top:14px}.cheat-t{font-family:'Fraunces',serif;font-size:16px;font-weight:700;color:var(--accent);margin-bottom:8px}.cheat-i{font-size:14px;color:var(--text);padding:5px 0;border-bottom:1px solid var(--border2)}
.ring{position:relative;display:inline-flex;align-items:center;justify-content:center}.ring svg{transform:rotate(-90deg)}.ring-v{position:absolute;font-family:'Space Mono',monospace;font-size:20px;font-weight:700;color:var(--bright)}
@keyframes up{from{opacity:0;transform:translateY(14px)}to{opacity:1;transform:translateY(0)}}.anim{animation:up .35s ease forwards}.d1{animation-delay:.06s;opacity:0}.d2{animation-delay:.12s;opacity:0}.d3{animation-delay:.18s;opacity:0}@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-5px)}75%{transform:translateX(5px)}}.shake{animation:shake .35s ease}@keyframes confDrop{0%{transform:translateY(-20px) rotate(0);opacity:1}100%{transform:translateY(50vh) rotate(720deg);opacity:0}}
@media(min-width:640px){body{font-size:18px}.cnt{padding:24px 24px 100px}.card{padding:24px 28px}}@media(min-width:768px){.app{max-width:700px;margin:0 auto;left:50%;transform:translateX(-50%);right:auto;width:100%;border-left:1px solid var(--border2);border-right:1px solid var(--border2)}.top,.bot{max-width:700px;left:50%;transform:translateX(-50%);right:auto;width:100%}.cnt{padding:28px 32px 110px}}@media(min-width:1024px){.app{max-width:780px}.top,.bot{max-width:780px}body{font-size:19px}}
</style>
</head>
<body>
<div class="app" id="app"></div>
<div id="confWrap" style="position:fixed;top:0;left:0;right:0;height:50vh;pointer-events:none;z-index:999;overflow:hidden"></div>
<script>
const IC={back:'<svg viewBox="0 0 24 24"><polyline points="15 18 9 12 15 6"/></svg>',book:'<svg viewBox="0 0 24 24"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg>',moon:'<svg viewBox="0 0 24 24"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>',sun:'<svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>',x:'<svg viewBox="0 0 24 24"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>',refresh:'<svg viewBox="0 0 24 24"><polyline points="23 4 23 10 17 10"/><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/></svg>'};
const MASTERY=0.8,SKEY='afcp_',LVL_N=['AnatomÃ­a del CC','Antes y DespuÃ©s','Â¿QuÃ© pasa si...?','La funciÃ³n bisagra','Descifra el caso'],LVL_E=['ğŸ”¬','âš™ï¸','ğŸ”„','ğŸ”—','ğŸ¥'],LVL_C=['var(--accent)','var(--gold)','var(--purple)','#059669','#db2777'];
let MOD=null,$a=null,streak=0,S={view:'home',mod:'m4',level:0,exIdx:0,seqIdx:0,pool:[],answers:{},tpOpen:false},P={};
function sKey(){return SKEY+S.mod}function loadP(){try{const d=localStorage.getItem(sKey());if(d)P=JSON.parse(d)}catch(e){}if(!P.scores)P.scores={};if(!P.errors)P.errors={};if(!P.skills)P.skills={}}function saveP(){try{localStorage.setItem(sKey(),JSON.stringify(P))}catch(e){}}
function isDk(){return document.documentElement.getAttribute('data-theme')==='dark'}function togDk(){const d=isDk()?'light':'dark';document.documentElement.setAttribute('data-theme',d);localStorage.setItem(SKEY+'theme',d);render()}
(function(){const t=localStorage.getItem(SKEY+'theme');if(t)document.documentElement.setAttribute('data-theme',t)})();
const $=id=>document.getElementById(id);function shuffle(a){const r=[...a];for(let i=r.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[r[i],r[j]]=[r[j],r[i]]}return r}function fireConfetti(){const w=$('confWrap');const cols=['#059669','#0891b2','#d97706','#db2777','#7c3aed'];for(let i=0;i<25;i++){const c=document.createElement('div');c.style.cssText=`position:absolute;width:${4+Math.random()*6}px;height:${4+Math.random()*6}px;left:${Math.random()*100}%;background:${cols[i%5]};border-radius:2px;animation:confDrop 1.2s ease-out ${Math.random()*0.3}s forwards;opacity:0;`;w.appendChild(c);setTimeout(()=>c.remove(),1600)}}

// ========== MODULE 4 DATA ==========
const MODULE={id:'m4',phase:'Fase 2 Â· Componentes',title:'Condicionamiento ClÃ¡sico',description:'CÃ³mo los estÃ­mulos neutros adquieren funciÃ³n: adquisiciÃ³n, extinciÃ³n, generalizaciÃ³n y la funciÃ³n bisagra.',icon:'ğŸ””',color:'#d97706',colorB:'#f59e0b',
levels:[
// ===== NIVEL 1: AnatomÃ­a del CC =====
{title:'Identifica los elementos del CC',description:'Dado un escenario, desmonta la secuencia: EI â†’ RI, EN â†’ EC â†’ RC.',showCount:11,
cheat:['EI = elicita respuesta innata','RI = respuesta no aprendida ante EI','EN = no produce respuesta especÃ­fica','EC = antes neutro, ahora elicita RC','RC = parecida a RI, pero aprendida','CC no enseÃ±a respuestas nuevas, solo nuevas relaciones Eâ†’R'],
theory:[
{icon:'ğŸ•',title:'La historia de Pavlov y el perro',color:'accent',body:'<p>Ivan Pavlov estudiaba la digestiÃ³n cuando notÃ³ algo extraÃ±o: sus perros salivaban <b>antes</b> de recibir comida, solo con ver al asistente que les alimentaba. Las llamÃ³ "secreciones psÃ­quicas" ğŸ¤”</p><p>DiseÃ±Ã³ un experimento: hizo sonar un diapasÃ³n ğŸ”” antes de dar comida ğŸ– al perro. Tras repetir esto varias veces...</p><div class="diag"><span class="phase ph-before">ğŸ”” Sonido solo</span> <span class="arrow">â†’</span> Nada relevante ğŸ˜<br><span class="phase ph-before">ğŸ– Comida en boca</span> <span class="arrow">â†’</span> ğŸ¤¤ SalivaciÃ³n (innata)<br><span class="label">â”€â”€ tras emparejamiento repetido â”€â”€</span><br><span class="phase ph-after">ğŸ”” Sonido solo</span> <span class="arrow">â†’</span> ğŸ¤¤ SalivaciÃ³n (Â¡aprendida!)</div><p>El perro aprendiÃ³ a <b>predecir</b> la comida por el sonido. AsÃ­ naciÃ³ el estudio del CC.</p>'},
{icon:'ğŸ§©',title:'Las 5 piezas del rompecabezas',color:'gold',body:'<div class="ex-box"><div class="ex-box-l">ğŸ– EI â€” EstÃ­mulo Incondicionado</div><p>Produce una respuesta <b>innata</b>, sin aprendizaje. Ej: comida â†’ salivaciÃ³n, dolor â†’ retirada.</p></div><div class="ex-box"><div class="ex-box-l">ğŸ¤¤ RI â€” Respuesta Incondicionada</div><p>La respuesta automÃ¡tica ante el EI. No se aprende, viene de "serie".</p></div><div class="ex-box"><div class="ex-box-l">ğŸ”” EN â€” EstÃ­mulo Neutro</div><p>No produce respuesta especÃ­fica ANTES del condicionamiento. Solo orientaciÃ³n ("Â¿quÃ© es eso?").</p></div><div class="ex-box"><div class="ex-box-l">âš¡ EC â€” EstÃ­mulo Condicionado</div><p>El EN transformado: tras asociarse con el EI, ahora elicita una respuesta similar. Â¡Ya no es neutro!</p></div><div class="ex-box"><div class="ex-box-l">ğŸ˜° RC â€” Respuesta Condicionada</div><p>Parecida a la RI pero <b>aprendida</b>. Generalmente de menor intensidad.</p></div><div class="callout"><em>ğŸ”‘ Regla clave:</em> El CC no enseÃ±a respuestas nuevas. Solo transfiere el control de un EI a un EC. Las respuestas ya existÃ­an.</div>'},
{icon:'âš¡',title:'Excitatorio vs Inhibitorio',color:'green',body:'<p>Hay dos grandes tipos de CC segÃºn la <b>contingencia</b> entre EC y EI:</p><div class="ex-box"><div class="ex-box-l">âœ… Excitatorio (contingencia positiva)</div><p>El EC predice la <b>apariciÃ³n</b> del EI â†’ se produce RC.<br>ğŸ“Œ Ej: Bata blanca + inyecciÃ³n dolorosa â†’ Bata blanca â†’ miedo.</p></div><div class="ex-box"><div class="ex-box-l">ğŸš« Inhibitorio (contingencia negativa)</div><p>El EC predice la <b>ausencia</b> del EI â†’ inhibe la RC.<br>ğŸ“Œ Ej: Una luz que siempre aparece cuando NO hay descarga â†’ la luz = seguridad.</p></div><p>AdemÃ¡s, el EI puede ser <b>apetitivo</b> (comida, placer) o <b>aversivo</b> (dolor, susto). La combinaciÃ³n genera 4 tipos de CC.</p>'}
],
exercises:[
{type:'order',skill:'anatomia_cc',text:'ğŸ• Ordena la secuencia del experimento de Pavlov:',items:['ğŸ”” Sonido del diapasÃ³n (EN) â€” no produce salivaciÃ³n','ğŸ– Comida en boca (EI) â€” produce salivaciÃ³n (RI)','ğŸ””+ğŸ– Se emparejan repetidamente','ğŸ”” Sonido solo (ahora EC) â€” produce salivaciÃ³n (RC)'],ok:'Â¡Perfecto! ğŸ¯ Primero el EN no hace nada, luego el EI produce RI, se emparejan, y el EN se convierte en EC.',fail:'ğŸ”‘ Regla: EN sin efecto â†’ EIâ†’RI â†’ Emparejamiento â†’ ECâ†’RC.',bonus:'La RC suele ser de menor intensidad que la RI. Â¡El perro salivaba menos con el sonido que con la comida real!'},
{type:'fill',skill:'anatomia_cc',text:'ğŸ• Completa el diagrama de Pavlov:',diagram:'<b>Antes:</b><br>ğŸ– {0} <span class="arrow">â†’</span> ğŸ¤¤ SalivaciÃ³n ({1})<br>ğŸ”” {2} <span class="arrow">â†’</span> ğŸ˜ Nada<br><br><b>DespuÃ©s:</b><br>ğŸ”” {3} <span class="arrow">â†’</span> ğŸ¤¤ SalivaciÃ³n ({4})',blanks:['EI','RI','EN','EC','RC'],options:['EI','RI','EN','EC','RC','EÎ”','Ed'],ok:'Â¡Diagrama perfecto! ğŸ§© Cada pieza en su lugar.',fail:'ğŸ”‘ Antes: EIâ†’RI y ENâ†’nada. DespuÃ©s: ECâ†’RC.',bonus:'EC y EN son el mismo objeto fÃ­sico (diapasÃ³n). Lo que cambiÃ³ fue su FUNCIÃ“N tras el emparejamiento.'},
{type:'single',skill:'anatomia_cc',text:'ğŸ¥ Ana fue al dentista. Le hicieron una endodoncia dolorosa. Ahora, al oler el consultorio, siente ansiedad. Â¿CuÃ¡l es el EI?',opts:['El olor del consultorio','El dolor de la endodoncia ğŸ¦·','La ansiedad','El dentista'],c:1,ok:'Â¡Eso es! ğŸ¯ El dolor = EI porque produce una respuesta innata (RI = activaciÃ³n/malestar).',fail:'ğŸ”‘ El EI siempre produce una respuesta INNATA sin aprendizaje previo.',bonus:'El olor era neutro (EN) hasta que se asociÃ³ con el dolor. Ahora es EC.'},
{type:'single',skill:'anatomia_cc',text:'ğŸ¥ En el caso de Ana, Â¿cuÃ¡l es la RC?',opts:['El dolor','La salivaciÃ³n','La ansiedad al oler el consultorio ğŸ˜°','El olor'],c:2,ok:'Â¡Correcto! ğŸ˜° La ansiedad ante el olor = RC. Es similar a la RI (malestar por dolor) pero APRENDIDA.',fail:'ğŸ”‘ La RC es la respuesta aprendida que ahora elicita el EC (olor).',bonus:'La ansiedad y la respuesta al dolor comparten componentes fisiolÃ³gicos (taquicardia, tensiÃ³n). Â¡Por eso la RC se parece a la RI!'},
{type:'classify',skill:'anatomia_cc',categories:['ğŸ– EI','âš¡ EC','ğŸ¤¤ RI','ğŸ˜° RC'],items:[
{text:'Comida en la boca del perro',cat:'ğŸ– EI'},
{text:'SalivaciÃ³n ante el sonido solo',cat:'ğŸ˜° RC'},
{text:'El sonido tras el emparejamiento',cat:'âš¡ EC'},
{text:'SalivaciÃ³n ante la comida',cat:'ğŸ¤¤ RI'},
{text:'El dolor de una descarga elÃ©ctrica',cat:'ğŸ– EI'},
{text:'Miedo al ver una bata blanca (tras inyecciones)',cat:'ğŸ˜° RC'}
]},
{type:'tf',skill:'anatomia_cc',s:'El CC enseÃ±a respuestas completamente nuevas que no existÃ­an antes. ğŸ†•',c:false,ok:'El CC NO enseÃ±a respuestas nuevas â€” solo transfiere el control estimular. La RC ya existÃ­a como RI.',fail:'ğŸ”‘ Regla: El CC aÃ±ade nuevos estÃ­mulos controladores pero no nuevas respuestas.',bonus:'Para aprender respuestas nuevas necesitamos el Condicionamiento Operante (M5).'},
{type:'tf',skill:'anatomia_cc',s:'La RC suele ser idÃ©ntica en intensidad a la RI. ğŸ“Š',c:false,ok:'Generalmente la RC es de <b>menor intensidad</b> que la RI. El perro salivaba menos con el sonido que con la comida.',fail:'ğŸ”‘ La RC es similar pero tÃ­picamente de menor intensidad que la RI.'},
{type:'single',skill:'anatomia_cc',text:'ğŸ‘ Lidell (1934): descarga en pata de oveja â†’ respira rÃ¡pido + levanta pata. Pone un metrÃ³nomo antes de cada descarga. Tras 5 ensayos, Â¿quÃ© pasa al sonar el metrÃ³nomo solo?',opts:['Nada, solo 5 ensayos no bastan','Levanta la pata y respira rÃ¡pido ğŸ‘ğŸ’¨','Solo levanta la pata','Se duerme'],c:1,ok:'ğŸ¯ Â¡Con solo 4-5 ensayos! El metrÃ³nomo (EC) ya elicita la RC completa. El CC aversivo puede ser muy rÃ¡pido.',fail:'ğŸ”‘ El CC aversivo puede establecerse en muy pocos ensayos.',bonus:'Un EI aversivo intenso puede condicionar en un solo ensayo (condicionamiento traumÃ¡tico). Por eso una sola experiencia puede generar una fobia.'},
{type:'single',skill:'anatomia_cc',text:'ğŸ• Comes mucho sushi ğŸ£ y te intoxicas. Ahora, ver sushi te da nÃ¡useas. Â¿QuÃ© tipo de CC es?',opts:['Excitatorio apetitivo','Excitatorio aversivo: el EC predice la apariciÃ³n de un EI aversivo (malestar) ğŸ¤¢','Inhibitorio aversivo','Inhibitorio apetitivo'],c:1,ok:'Â¡Exacto! ğŸ¯ EC (sushi) predice EI aversivo (malestar) = excitatorio aversivo.',fail:'ğŸ”‘ Excitatorio = EC predice APARICIÃ“N del EI. Aversivo = el EI es desagradable.',bonus:'La aversiÃ³n condicionada al sabor es especial: puede establecerse con UN solo emparejamiento y con horas de intervalo entre sabor y malestar.'},
{type:'order',skill:'anatomia_cc',text:'ğŸ‘¶ Watson y Rayner (1920): El pequeÃ±o Albert. Ordena lo que hicieron:',items:['Albert juega con una rata blanca (EN) sin miedo ğŸ€ğŸ˜Š','Hacen sonar una barra de metal fuerte (EI) detrÃ¡s de Ã©l â†’ llanto (RI) ğŸ˜±','Emparejan: rata + golpe fuerte, varias veces ğŸ€ğŸ”¨','Albert ve la rata sola â†’ llora y retrocede (RC) ğŸ€ğŸ˜­'],ok:'ğŸ¯ Â¡Secuencia correcta! Uno de los experimentos mÃ¡s famosos (y polÃ©micos) de la historia.',fail:'ğŸ”‘ EN sin efecto â†’ EIâ†’RI â†’ Emparejamiento â†’ ECâ†’RC.',bonus:'Albert tambiÃ©n mostrÃ³ miedo a objetos similares (conejo blanco, abrigo de piel). Â¡Eso es generalizaciÃ³n! Lo veremos en el Nivel 3.'},
{type:'tf',skill:'anatomia_cc',s:'En el CC inhibitorio, el EC predice que el EI NO va a aparecer. ğŸš«',c:true,ok:'Â¡Correcto! ğŸ›¡ï¸ El EC inhibitorio es una "seÃ±al de seguridad" â€” predice la ausencia del EI.',fail:'ğŸ”‘ Inhibitorio = contingencia negativa: el EC predice la NO apariciÃ³n del EI.'}
]},
// ===== NIVEL 2: Antes y DespuÃ©s =====
{title:'Antes y despuÃ©s del condicionamiento',description:'Predice quÃ© ocurre antes, durante y despuÃ©s de la asociaciÃ³n EC-EI.',showCount:10,
cheat:['ANTES: ENâ†’nada, EIâ†’RI','DURANTE: EN+EI repetidamente','DESPUÃ‰S: ECâ†’RC (EN se transformÃ³)','La contingencia (predictibilidad) importa mÃ¡s que la contigÃ¼idad (cercanÃ­a temporal)','El EC debe presentarse ANTES del EI para que funcione bien'],
theory:[
{icon:'â±ï¸',title:'El momento importa: tipos de emparejamiento',color:'accent',body:'<p>No basta con que EC y EI aparezcan juntos. El <b>orden temporal</b> importa mucho:</p><div class="ex-box"><div class="ex-box-l">â© Demora corta (el mejor)</div><p>El EC aparece <b>primero</b> y el EI llega poco despuÃ©s. El EC predice al EI. MÃ¡ximo aprendizaje.</p></div><div class="ex-box"><div class="ex-box-l">â¸ï¸ De huella</div><p>EC aparece y termina ANTES de que llegue el EI. Hay un intervalo vacÃ­o. Funciona pero es mÃ¡s difÃ­cil.</p></div><div class="ex-box"><div class="ex-box-l">âª Hacia atrÃ¡s</div><p>El EI aparece ANTES que el EC. Muy poco o nulo condicionamiento â€” el EC no predice nada.</p></div><div class="callout"><em>ğŸ”‘ Principio:</em> Lo crucial es que el EC tenga <b>valor predictivo</b> (contingencia), no solo cercanÃ­a temporal (contigÃ¼idad). Si el EI aparece igual con o sin el EC, no hay condicionamiento.</div>'},
{icon:'ğŸ“Š',title:'La adquisiciÃ³n: curva de aprendizaje',color:'gold',body:'<p>La <b>adquisiciÃ³n</b> es el incremento gradual de la RC con cada emparejamiento EC+EI:</p><div class="diag"><span class="label">Curva de adquisiciÃ³n tÃ­pica</span><br>Ensayo 1: ğŸ””+ğŸ– â†’ ğŸ’§ (poca salivaciÃ³n)<br>Ensayo 5: ğŸ””+ğŸ– â†’ ğŸ’§ğŸ’§ (mÃ¡s)<br>Ensayo 10: ğŸ””+ğŸ– â†’ ğŸ’§ğŸ’§ğŸ’§ (bastante)<br>Ensayo 20: ğŸ””+ğŸ– â†’ ğŸ’§ğŸ’§ğŸ’§ğŸ’§ (estable)<br><span class="label">â”€â”€ asÃ­ntota: la RC ya no crece mÃ¡s â”€â”€</span></div><div class="callout callout-g"><em>âš ï¸ ExcepciÃ³n:</em> Con EI aversivos intensos (dolor fuerte, susto), puede bastar <b>1 solo ensayo</b>. Es lo que ocurre en el trauma: una sola experiencia puede generar CC duradero.</div>'}
],
exercises:[
{type:'fill',skill:'antes_despues',text:'ğŸ”” Completa el diagrama ANTES y DESPUÃ‰S:',diagram:'<span class="phase ph-before">ANTES del CC</span><br>ğŸ– Comida ({0}) <span class="arrow">â†’</span> ğŸ¤¤ SalivaciÃ³n ({1})<br>ğŸ”” DiapasÃ³n ({2}) <span class="arrow">â†’</span> ğŸ˜ OrientaciÃ³n<br><br><span class="phase ph-after">DESPUÃ‰S del CC</span><br>ğŸ”” DiapasÃ³n ({3}) <span class="arrow">â†’</span> ğŸ¤¤ SalivaciÃ³n ({4})',blanks:['EI','RI','EN','EC','RC'],options:['EI','RI','EN','EC','RC','Ed'],ok:'ğŸ¯ Â¡TransformaciÃ³n completa! El EN se convirtiÃ³ en EC.',fail:'ğŸ”‘ ANTES: EIâ†’RI, ENâ†’nada. DESPUÃ‰S: ECâ†’RC.'},
{type:'single',skill:'antes_despues',text:'â±ï¸ Pedro oye un trueno 0.5 seg DESPUÃ‰S de ver el relÃ¡mpago. Se asusta con el trueno. Â¿Tipo de emparejamiento EC-EI?',opts:['De demora corta: el relÃ¡mpago (EC) predice al trueno (EI) âš¡â†’ğŸ’¥','De huella','Hacia atrÃ¡s','SimultÃ¡neo'],c:0,ok:'ğŸ¯ El EC (relÃ¡mpago) aparece justo antes del EI (trueno). Demora corta = condicionamiento Ã³ptimo.',fail:'ğŸ”‘ Demora corta: EC primero â†’ EI poco despuÃ©s. MÃ¡xima predictibilidad.',bonus:'Esto ocurre naturalmente: relÃ¡mpago â†’ trueno, nubes negras â†’ lluvia. Â¡La naturaleza nos enseÃ±a por CC!'},
{type:'single',skill:'antes_despues',text:'ğŸ”¬ Un investigador presenta el EI ANTES que el EC. Â¿Resultado?',opts:['Condicionamiento rÃ¡pido','Condicionamiento normal','Poco o nulo condicionamiento: el EC no predice al EI âŒ','Condicionamiento inhibitorio'],c:2,ok:'âœ… El CC hacia atrÃ¡s produce poco o nulo condicionamiento. El EC no tiene valor predictivo.',fail:'ğŸ”‘ El EC debe aparecer ANTES del EI para que prediga su ocurrencia.'},
{type:'tf',skill:'antes_despues',s:'Lo Ãºnico que importa para el CC es que EC y EI estÃ©n cerca en el tiempo (contigÃ¼idad). â³',c:false,ok:'La <b>contingencia</b> (predictibilidad) importa mÃ¡s que la contigÃ¼idad (cercanÃ­a). Si el EI aparece igual con o sin EC, no hay condicionamiento.',fail:'ğŸ”‘ Contingencia > ContigÃ¼idad. La predictibilidad es la clave, no solo la cercanÃ­a.',bonus:'Experimento de Rescorla (1968): demostrÃ³ que si el EI aparece tanto con EC como sin Ã©l, no se condiciona. Â¡Debe ser predictivo!'},
{type:'single',skill:'antes_despues',text:'ğŸ˜± MarÃ­a tuvo un accidente de coche grave. Con UN solo evento, ahora le aterra subir a un coche. Â¿Esto contradice la idea de "emparejamiento repetido"?',opts:['SÃ­, el CC siempre necesita repeticiÃ³n','No: con EI aversivos muy intensos, un solo ensayo basta para el CC ğŸ’¥','No es CC, es algo diferente','SÃ­, es solo estrÃ©s'],c:1,ok:'ğŸ¯ El condicionamiento traumÃ¡tico puede establecerse en 1 ensayo. A mayor intensidad del EI, menos repeticiones se necesitan.',fail:'ğŸ”‘ EI aversivo intenso â†’ CC en un solo ensayo. No contradice el CC, es un caso especial.'},
{type:'order',skill:'antes_despues',text:'ğŸ“Š Ordena las fases del CC de una fobia a las araÃ±as:',items:['MarÃ­a ve araÃ±as (EN) con ligera inquietud pero sin miedo intenso ğŸ•·ï¸','Una araÃ±a le pica dolorosamente (EI) â†’ dolor y activaciÃ³n intensa (RI) ğŸ•·ï¸ğŸ’¢','Emparejamiento: araÃ±a + dolor (puede bastar 1 vez si es intenso)','Ahora ver cualquier araÃ±a (EC) â†’ taquicardia y huida (RC) ğŸ•·ï¸ğŸ˜±'],ok:'ğŸ¯ Â¡Secuencia correcta! De EN a EC por asociaciÃ³n con EI aversivo.',fail:'ğŸ”‘ ENâ†’nada problemÃ¡tico â†’ EIâ†’RI â†’ AsociaciÃ³n â†’ ECâ†’RC.'},
{type:'tf',skill:'antes_despues',s:'Si el EI es muy intenso (dolor fuerte, susto traumÃ¡tico), puede bastar un solo emparejamiento para establecer el CC. ğŸ’¥',c:true,ok:'Â¡Correcto! ğŸ’¥ A mayor intensidad del EI, menos ensayos se necesitan. Es la base del condicionamiento traumÃ¡tico.',fail:'ğŸ”‘ Intensidad del EI y nÃºmero de ensayos tienen relaciÃ³n inversa.'},
{type:'single',skill:'antes_despues',text:'ğŸ”” En el CC excitatorio apetitivo, Â¿quÃ© relaciÃ³n tiene el EC con el EI?',opts:['EC predice la apariciÃ³n de un EI apetitivo ğŸ–âœ…','EC predice la ausencia del EI','EC aparece despuÃ©s del EI','No hay relaciÃ³n'],c:0,ok:'ğŸ¯ Excitatorio = predice apariciÃ³n. Apetitivo = el EI es agradable.',fail:'ğŸ”‘ Excitatorio apetitivo: EC â†’ apariciÃ³n de EI agradable.',bonus:'Ejemplo cotidiano: el sonido del microondas (EC) â†’ apariciÃ³n de comida caliente (EI). Â¡Tu salivaciÃ³n ante el "bip" es RC!'},
{type:'fill',skill:'antes_despues',text:'ğŸ¥ Completa: Fobia al dentista',diagram:'<span class="phase ph-before">ANTES</span><br>ğŸ˜¬ Dolor del torno ({0}) <span class="arrow">â†’</span> ğŸ˜± ActivaciÃ³n/llanto ({1})<br>ğŸ¥ Olor del consultorio ({2}) <span class="arrow">â†’</span> ğŸ˜ Nada<br><br><span class="phase ph-after">DESPUÃ‰S</span><br>ğŸ¥ Olor solo ({3}) <span class="arrow">â†’</span> ğŸ˜° Ansiedad ({4})',blanks:['EI','RI','EN','EC','RC'],options:['EI','RI','EN','EC','RC','Ed','EÎ”'],ok:'ğŸ¯ Â¡Perfecto! El olor adquiriÃ³ funciÃ³n de EC aversivo.',fail:'ğŸ”‘ Dolor=EI, ActivaciÃ³n=RI, Olor=ENâ†’EC, Ansiedad=RC.'},
{type:'tf',skill:'antes_despues',s:'El CC solo funciona con estÃ­mulos aversivos (dolor, miedo). ğŸ˜¨',c:false,ok:'Â¡No! ğŸµ TambiÃ©n funciona con EI apetitivos: comida, placer, afecto. Ej: el olor de la cocina de tu abuela â†’ alegrÃ­a y "hambre" condicionada.',fail:'ğŸ”‘ CC funciona con EI apetitivos Y aversivos. Cuatro combinaciones posibles.'}
]},
// ===== NIVEL 3: Â¿QuÃ© pasa si...? =====
{title:'FenÃ³menos: Â¿quÃ© pasa cuando cambias algo?',description:'ExtinciÃ³n, generalizaciÃ³n, discriminaciÃ³n, recuperaciÃ³n espontÃ¡nea y CC de 2Âº orden.',showCount:12,
cheat:['ExtinciÃ³n: EC sin EI repetidamente â†’ RC disminuye (NO es olvido)','RecuperaciÃ³n espontÃ¡nea: tras descanso post-extinciÃ³n, RC reaparece parcialmente','GeneralizaciÃ³n: estÃ­mulos similares al EC tambiÃ©n elicitan RC','DiscriminaciÃ³n: responder diferente a estÃ­mulos diferentes','CC 2Âº orden: ECâ‚ puede condicionar un EN nuevo â†’ ECâ‚‚'],
theory:[
{icon:'ğŸ“‰',title:'ExtinciÃ³n: "dejÃ³ de funcionar"',color:'accent',body:'<p>Â¿QuÃ© pasa si presentamos el EC sin el EI muchas veces? ğŸ¤”</p><div class="diag"><span class="phase ph-during">ExtinciÃ³n</span><br>ğŸ”” EC solo â†’ ğŸ’§ğŸ’§ğŸ’§ (ensayo 1)<br>ğŸ”” EC solo â†’ ğŸ’§ğŸ’§ (ensayo 5)<br>ğŸ”” EC solo â†’ ğŸ’§ (ensayo 10)<br>ğŸ”” EC solo â†’ âˆ… (ensayo 20)<br><span class="label">â”€â”€ la RC desaparece gradualmente â”€â”€</span></div><div class="callout-r callout"><em>âš ï¸ Â¡Pero NO es olvido!</em> La extinciÃ³n es un <b>nuevo aprendizaje</b>: el organismo aprende que, en este contexto, el EC ya no predice al EI. La asociaciÃ³n original no se borra â€” se superpone una nueva.</div><p>Prueba de que no se borra: la <b>recuperaciÃ³n espontÃ¡nea</b>. Tras un periodo de descanso, el EC vuelve a elicitar RC (menor que antes). ğŸ“ˆ</p><div class="diag"><span class="phase ph-during">RecuperaciÃ³n espontÃ¡nea</span><br>Post-extinciÃ³n: ğŸ”” â†’ âˆ… ğŸ˜Œ<br>â¸ï¸ Descanso de 24h...<br>DÃ­a siguiente: ğŸ”” â†’ ğŸ’§ğŸ’§ (Â¡vuelve!) ğŸ˜®<br><span class="label">â”€â”€ nivel inferior al original pero superior al final de extinciÃ³n â”€â”€</span></div>'},
{icon:'ğŸŒŠ',title:'GeneralizaciÃ³n y DiscriminaciÃ³n',color:'gold',body:'<p><b>GeneralizaciÃ³n:</b> estÃ­mulos <b>parecidos</b> al EC tambiÃ©n elicitan RC, aunque nunca se emparejaron con el EI.</p><div class="ex-box"><div class="ex-box-l">ğŸ• Ejemplo clÃ¡sico</div><p>Albert temÃ­a la rata blanca (EC). TambiÃ©n empezÃ³ a temer al conejo blanco, al abrigo de piel, e incluso a una mÃ¡scara de Santa Claus con barba. ğŸ€â†’ğŸ°â†’ğŸ§¥â†’ğŸ…<br><br>Cuanto mÃ¡s parecido al EC â†’ mÃ¡s intensa la RC.<br>Cuanto mÃ¡s diferente â†’ menos RC.</p></div><p><b>DiscriminaciÃ³n:</b> el proceso opuesto. Un niÃ±o dice "guau-guau" ğŸ• a todos los animales de 4 patas, pero aprende a decir "perro" solo ante perros y "vaca" ante vacas. Responde diferente a estÃ­mulos diferentes.</p>'},
{icon:'ğŸ”—',title:'CC de segundo orden: la cadena se extiende',color:'green',body:'<p>Un EC establecido puede funcionar como "EI" para condicionar un <b>nuevo</b> estÃ­mulo:</p><div class="diag">ğŸ¥ Bata blanca + ğŸ’‰ Dolor â†’ ğŸ˜° RCâ‚<br><span class="label">â”€â”€ primer orden establecido â”€â”€</span><br>ğŸ§³ MaletÃ­n + ğŸ¥ Bata blanca â†’ ğŸ˜° RCâ‚‚<br><span class="label">â”€â”€ segundo orden: maletÃ­n predice bata, bata predice dolor â”€â”€</span><br>ğŸ§³ MaletÃ­n solo â†’ ğŸ˜° Ansiedad leve</div><div class="callout callout-g"><em>ğŸ’¡ ImplicaciÃ³n:</em> El CC de 2Âº orden extiende enormemente el aprendizaje. No necesitas experiencia directa con el EI â€” basta con que un EC ya establecido se asocie con un nuevo EN.</div>'}
],
exercises:[
{type:'single',skill:'fenomenos_cc',text:'ğŸ“‰ Presentas el EC sin el EI 50 veces y la RC desaparece. Â¿QuÃ© ha ocurrido?',opts:['El organismo olvidÃ³ la asociaciÃ³n','Se borrÃ³ el aprendizaje original','ExtinciÃ³n: nuevo aprendizaje que NO borra el original ğŸ”„','HabituaciÃ³n'],c:2,ok:'ğŸ¯ Â¡Clave! La extinciÃ³n es nuevo aprendizaje, no olvido ni borrado.',fail:'ğŸ”‘ Regla: ExtinciÃ³n â‰  olvido. Es un nuevo aprendizaje que se superpone al original.',bonus:'Prueba: tras un descanso, la RC reaparece (recuperaciÃ³n espontÃ¡nea). Si se hubiera borrado, no podrÃ­a volver.'},
{type:'single',skill:'fenomenos_cc',text:'â¸ï¸ Tras extinguir la RC, el sujeto descansa 24h. Al presentar el EC de nuevo, Â¿quÃ© pasa?',opts:['Nada, estÃ¡ extinguido','La RC reaparece parcialmente (recuperaciÃ³n espontÃ¡nea) ğŸ“ˆ','La RC es mÃ¡s fuerte que nunca','El sujeto tiene una RC diferente'],c:1,ok:'ğŸ¯ RecuperaciÃ³n espontÃ¡nea: la RC vuelve a un nivel intermedio entre el original y cero.',fail:'ğŸ”‘ Tras descanso post-extinciÃ³n, la RC reaparece parcialmente. Demuestra que la asociaciÃ³n no se borrÃ³.'},
{type:'tf',skill:'fenomenos_cc',s:'La extinciÃ³n en CC consiste en presentar el EC repetidamente sin el EI. ğŸ””âŒğŸ–',c:true,ok:'Â¡Exacto! ğŸ”” sin ğŸ– â†’ la RC disminuye gradualmente. El organismo aprende que EC ya no predice EI.',fail:'ğŸ”‘ ExtinciÃ³n = EC sin EI repetidamente â†’ RC disminuye.'},
{type:'single',skill:'fenomenos_cc',text:'ğŸ€ Albert teme la rata (EC). TambiÃ©n teme un conejo blanco. Â¿QuÃ© fenÃ³meno es?',opts:['DiscriminaciÃ³n','GeneralizaciÃ³n: estÃ­mulos similares al EC tambiÃ©n elicitan RC ğŸŒŠ','ExtinciÃ³n','RecuperaciÃ³n espontÃ¡nea'],c:1,ok:'ğŸ¯ GeneralizaciÃ³n: la RC se extiende a estÃ­mulos que comparten propiedades con el EC.',fail:'ğŸ”‘ GeneralizaciÃ³n: similitud con EC â†’ RC (menor cuanto mÃ¡s diferente).',bonus:'El gradiente de generalizaciÃ³n: cuanto mÃ¡s parecido al EC original, mÃ¡s intensa la RC. Â¡Es un continuo, no un todo/nada!'},
{type:'order',skill:'fenomenos_cc',text:'ğŸ”— Ordena el CC de segundo orden (fobia al dentista):',items:['ğŸ’‰ InyecciÃ³n (EI) â†’ ğŸ˜± Dolor/miedo (RI)','ğŸ¥ Bata blanca + ğŸ’‰ InyecciÃ³n â†’ se asocian','ğŸ¥ Bata blanca (ECâ‚) â†’ ğŸ˜° Ansiedad (RCâ‚)','ğŸ§³ MaletÃ­n mÃ©dico + ğŸ¥ Bata blanca â†’ se asocian','ğŸ§³ MaletÃ­n solo (ECâ‚‚) â†’ ğŸ˜° Ansiedad leve (RCâ‚‚)'],ok:'ğŸ¯ Â¡Cadena perfecta! El ECâ‚ funciona como "EI" para condicionar ECâ‚‚.',fail:'ğŸ”‘ Primero se establece ECâ‚, luego ECâ‚ condiciona ECâ‚‚.'},
{type:'single',skill:'fenomenos_cc',text:'ğŸ• Un perro saliva ante un tono de 1000Hz (EC). Â¿SalivarÃ¡ ante 950Hz?',opts:['No, es un tono diferente','SÃ­, pero menos que ante 1000Hz (generalizaciÃ³n) ğŸ“‰','SÃ­, exactamente igual','Solo si se recondiciona'],c:1,ok:'ğŸ¯ GeneralizaciÃ³n con gradiente: similar al EC â†’ RC, pero menor cuanto mÃ¡s difiera.',fail:'ğŸ”‘ Gradiente de generalizaciÃ³n: a mayor diferencia con EC, menor RC.'},
{type:'tf',skill:'fenomenos_cc',s:'El CC de segundo orden permite aprender miedos sin experiencia directa con el EI. ğŸ”—',c:true,ok:'Â¡Exacto! ğŸ”— No necesitas sufrir dolor directamente â€” basta que un EC ya establecido se asocie con un nuevo estÃ­mulo.',fail:'ğŸ”‘ CC de 2Âº orden extiende el aprendizaje sin experiencia directa con EI.',bonus:'Esto explica miedos aparentemente "irracionales" donde la persona no recuerda una experiencia traumÃ¡tica directa.'},
{type:'classify',skill:'fenomenos_cc',categories:['ğŸ“‰ ExtinciÃ³n','ğŸŒŠ GeneralizaciÃ³n','ğŸ¯ DiscriminaciÃ³n','ğŸ“ˆ RecuperaciÃ³n espontÃ¡nea'],items:[
{text:'EC sin EI â†’ RC disminuye',cat:'ğŸ“‰ ExtinciÃ³n'},
{text:'Temer perros grandes Y pequeÃ±os (solo fue mordido por uno grande)',cat:'ğŸŒŠ GeneralizaciÃ³n'},
{text:'Tras descanso post-extinciÃ³n, la RC reaparece parcialmente',cat:'ğŸ“ˆ RecuperaciÃ³n espontÃ¡nea'},
{text:'Temer al pastor alemÃ¡n que le mordiÃ³ pero no a su propio perro',cat:'ğŸ¯ DiscriminaciÃ³n'},
{text:'Un niÃ±o llama "guau" a todos los animales de 4 patas',cat:'ğŸŒŠ GeneralizaciÃ³n'},
{text:'El niÃ±o aprende a decir "perro" solo ante perros',cat:'ğŸ¯ DiscriminaciÃ³n'}
]},
{type:'single',skill:'fenomenos_cc',text:'ğŸ’¡ La incubaciÃ³n (Eysenck) ocurre cuando exposiciones breves e intensas al EC, en lugar de extinguir la RC, la AUMENTAN. Â¿CuÃ¡ndo pasa esto?',opts:['Siempre','Cuando el EC y la RC son muy potentes y la exposiciÃ³n es breve (el sujeto sale aÃºn activado) âš ï¸','Nunca, es un mito','Solo con EI apetitivos'],c:1,ok:'ğŸ¯ La incubaciÃ³n: si la exposiciÃ³n es breve y la activaciÃ³n alta, la RC se puede intensificar en vez de extinguirse.',fail:'ğŸ”‘ IncubaciÃ³n: EC potente + RC intensa + exposiciÃ³n breve = RC se intensifica.',bonus:'Esto explica por quÃ© la exposiciÃ³n terapÃ©utica debe ser prolongada. Â¡Exposiciones cortas pueden empeorar la fobia!'},
{type:'tf',skill:'fenomenos_cc',s:'Si tras una extinciÃ³n completa, volvemos a emparejar EC+EI, el reacondicionamiento es mÃ¡s rÃ¡pido que el condicionamiento original. âš¡',c:true,ok:'Â¡Correcto! âš¡ El reacondicionamiento es mÃ¡s rÃ¡pido porque la asociaciÃ³n original no se borrÃ³ â€” solo se inhibiÃ³.',fail:'ğŸ”‘ Reacondicionamiento mÃ¡s rÃ¡pido = prueba de que la extinciÃ³n no borrÃ³ la asociaciÃ³n.',bonus:'Tres pruebas de que la extinciÃ³n no es borrado: recuperaciÃ³n espontÃ¡nea, renovaciÃ³n del contexto, y reacondicionamiento rÃ¡pido.'},
{type:'single',skill:'fenomenos_cc',text:'ğŸ§  Â¿CuÃ¡l es la diferencia fundamental entre extinciÃ³n y olvido?',opts:['No hay diferencia','La extinciÃ³n es un nuevo aprendizaje activo; el olvido es pasivo por paso del tiempo ğŸ“š','La extinciÃ³n es mÃ¡s rÃ¡pida','El olvido es un nuevo aprendizaje'],c:1,ok:'ğŸ¯ Â¡Clave! ExtinciÃ³n = aprendizaje activo (EC sin EI). Olvido = deterioro pasivo por el tiempo.',fail:'ğŸ”‘ ExtinciÃ³n = proceso activo de aprendizaje. Olvido = deterioro pasivo.'}
]},
// ===== NIVEL 4: La funciÃ³n bisagra =====
{title:'La RC como E interno: secuencias compuestas',description:'CÃ³mo el CC se conecta con el CO â€” el modelo bifactorial de Mowrer.',showCount:8,
cheat:['La RC puede funcionar como E interno para una operante','Modelo bifactorial: CC (Eâ†’RC) + CO (RC como Edâ†’ROâ†’consecuencia)','Emociones = RC que motivan conducta operante','La "funciÃ³n bisagra" = la RC conecta ambas secuencias','En clÃ­nica, la mayorÃ­a de secuencias son compuestas'],
theory:[
{icon:'ğŸ”—',title:'Mowrer y el enganche de dos secuencias',color:'accent',body:'<p>Mowrer (1947, 1960) propuso que gran parte del comportamiento humano se explica por la <b>uniÃ³n de dos secuencias</b>:</p><div class="diag"><span class="phase ph-before">1ï¸âƒ£ SECUENCIA RESPONDIENTE (CC)</span><br>ğŸ™ï¸ SituaciÃ³n (EC) <span class="arrow">â†’</span> ğŸ˜° Ansiedad (RC)<br><br><span class="phase ph-during">âš¡ FUNCIÃ“N BISAGRA</span><br>ğŸ˜° Ansiedad (RC) funciona como <b>E interno</b><br><br><span class="phase ph-after">2ï¸âƒ£ SECUENCIA OPERANTE (CO)</span><br>ğŸ˜° E interno <span class="arrow">â†’</span> ğŸƒ Huida (RO) <span class="arrow">â†’</span> ğŸ˜Œ Alivio (R-)</div><div class="callout"><em>ğŸ’¡ La clave:</em> La RC (ansiedad) cumple <b>doble funciÃ³n</b>: es respuesta del CC y estÃ­mulo antecedente del CO. Es el "bisagra" que engancha ambas secuencias.</div>'},
{icon:'ğŸ˜±',title:'Las fobias: el ejemplo perfecto',color:'gold',body:'<p>SegÃºn Mowrer, la conducta fÃ³bica se aprende en dos partes:</p><div class="ex-box"><div class="ex-box-l">Parte 1: CC â†’ se aprende el miedo</div><p>Una situaciÃ³n neutra se asocia con un EI aversivo â†’ la situaciÃ³n se convierte en EC â†’ elicita ansiedad (RC).</p></div><div class="ex-box"><div class="ex-box-l">Parte 2: CO â†’ se aprende la evitaciÃ³n</div><p>La ansiedad (RC/E interno) â†’ el sujeto escapa o evita â†’ la ansiedad se reduce (R-) â†’ la evitaciÃ³n se mantiene.</p></div><div class="callout callout-g"><em>âš ï¸ Trampa clÃ­nica:</em> La evitaciÃ³n se mantiene por R- (reducciÃ³n de ansiedad), lo que impide la extinciÃ³n natural. Â¡El sujeto nunca comprueba que el EC ya no predice al EI! Por eso las fobias no se "pasan solas".</div>'},
{icon:'ğŸ§ ',title:'Emociones como RC',color:'green',body:'<p>Skinner seÃ±alÃ³ que las emociones no son <b>causas</b> de conducta, pero sÃ­ <b>circunstancias antecedentes</b> que afectan la probabilidad de emisiÃ³n.</p><p>Desde el modelo bifactorial:</p><div class="ex-box"><div class="ex-box-l">ğŸ“Œ Las emociones = RC fisiolÃ³gicas</div><p>Taquicardia, sudoraciÃ³n, opresiÃ³n, tensiÃ³n muscular... son respuestas condicionadas ante EC. Constituyen el componente <b>respondiente</b> de lo que llamamos "emociÃ³n".</p></div><p>Estas RC pueden funcionar como Ed para operantes: "siento taquicardia â†’ me voy" o como OM que alteran el valor reforzante de ciertos estÃ­mulos.</p>'}
],
exercises:[
{type:'fill',skill:'bisagra',text:'ğŸ”— Completa la secuencia bifactorial de una fobia:',diagram:'<span class="phase ph-before">CC:</span> ğŸ™ï¸ Plaza llena ({0}) <span class="arrow">â†’</span> ğŸ˜° Taquicardia ({1})<br><br><span class="phase ph-during">BISAGRA:</span> ğŸ˜° Taquicardia funciona como {2}<br><br><span class="phase ph-after">CO:</span> {3} <span class="arrow">â†’</span> ğŸƒ Salir de la plaza (RO) <span class="arrow">â†’</span> ğŸ˜Œ Alivio ({4})',blanks:['EC','RC','E interno','E interno','R-'],options:['EC','RC','E interno','R-','R+','EI','RI','Ed'],ok:'ğŸ¯ Â¡Secuencia bifactorial completa! La RC es el bisagra entre CC y CO.',fail:'ğŸ”‘ ECâ†’RC (CC), RC=E interno (bisagra), E internoâ†’ROâ†’R- (CO).'},
{type:'single',skill:'bisagra',text:'ğŸƒ Â¿Por quÃ© las fobias no se "pasan solas" con el tiempo?',opts:['Porque el miedo es innato','Porque la evitaciÃ³n impide la extinciÃ³n: el sujeto nunca comprueba que el EC ya no es peligroso ğŸ”’','Porque son genÃ©ticas','Porque el EI sigue presente'],c:1,ok:'ğŸ¯ Â¡Exacto! La evitaciÃ³n (mantenida por R-) impide la exposiciÃ³n al EC sin EI, bloqueando la extinciÃ³n.',fail:'ğŸ”‘ EvitaciÃ³n â†’ no exposiciÃ³n â†’ no extinciÃ³n â†’ el miedo se mantiene. CÃ­rculo vicioso.',bonus:'Por eso la exposiciÃ³n es el tratamiento de elecciÃ³n para fobias: rompe el ciclo al permitir que el EC ocurra sin el EI.'},
{type:'single',skill:'bisagra',text:'ğŸ˜° Carlos ve un ascensor (EC) â†’ taquicardia (RC) â†’ sube por escaleras (RO) â†’ taquicardia baja (R-). Â¿QuÃ© funciÃ³n cumple la taquicardia?',opts:['Solo es una RC','Doble: RC del CC y E interno (Ed) para la operante de subir escaleras ğŸ”—','Es un EI','Es una RI'],c:1,ok:'ğŸ¯ Â¡La funciÃ³n bisagra! La RC es simultÃ¡neamente respuesta (del CC) y estÃ­mulo (para el CO).',fail:'ğŸ”‘ FunciÃ³n bisagra: la RC cumple doble papel â€” respuesta Y estÃ­mulo.'},
{type:'tf',skill:'bisagra',s:'SegÃºn Mowrer, las emociones son la causa primera de la conducta. â¤ï¸',c:false,ok:'Mowrer las ve como <b>antecedentes</b> de operantes, no como "causa primera". Son RC condicionadas que motivan conductas instrumentales.',fail:'ğŸ”‘ Emociones = RC antecedentes, no causas primeras. Son conducta que tambiÃ©n necesita explicaciÃ³n.',bonus:'Skinner: las emociones son "circunstancias que afectan la probabilidad de emisiÃ³n" de operantes. No son causas, son parte de la secuencia.'},
{type:'order',skill:'bisagra',text:'ğŸ”— Ordena la secuencia completa de una fobia a conducir (tras accidente):',items:['ğŸš— Ver el coche (EC) elicita ansiedad/taquicardia (RC) â€” CC','ğŸ˜° La taquicardia funciona como E interno â€” BISAGRA','ğŸƒ Pedir a otro que conduzca (RO) â€” CO','ğŸ˜Œ La ansiedad se reduce (R-) â€” Consecuencia que mantiene la evitaciÃ³n'],ok:'ğŸ¯ Â¡Secuencia bifactorial completa! CC â†’ Bisagra â†’ CO â†’ R-.',fail:'ğŸ”‘ ECâ†’RC (CC), RC=E interno, E internoâ†’RO (CO), ROâ†’R-.'},
{type:'single',skill:'bisagra',text:'ğŸ§  Â¿CuÃ¡l es la implicaciÃ³n clÃ­nica principal de que la evitaciÃ³n se mantenga por R-?',opts:['No tiene implicaciÃ³n','Hay que exponer al EC sin el EI para que ocurra la extinciÃ³n del CC ğŸ¯','Solo hay que cambiar pensamientos','Solo hay que medicar'],c:1,ok:'ğŸ¯ La exposiciÃ³n rompe el ciclo: EC sin EI â†’ extinciÃ³n del CC â†’ la RC se reduce â†’ la evitaciÃ³n pierde su reforzador.',fail:'ğŸ”‘ ExposiciÃ³n = EC sin EI â†’ extinciÃ³n de la RC â†’ la evitaciÃ³n ya no es necesaria.'},
{type:'tf',skill:'bisagra',s:'En la secuencia bifactorial, la RO puede afectar solo al E interno (RC) o tambiÃ©n al E externo (EC). ğŸ¯',c:true,ok:'Â¡Exacto! A veces la operante reduce solo la RC interna (relajarse) y otras veces elimina tambiÃ©n el EC externo (irse del sitio). El AFC debe detectar a quÃ© afecta.',fail:'ğŸ”‘ La RO puede afectar a uno o ambos: E interno (RC) y/o E externo (EC).',bonus:'Ejemplo: "relajar los mÃºsculos" afecta al E interno. "Salir del examen" afecta a ambos. Â¡Importante para planificar la intervenciÃ³n!'},
{type:'single',skill:'bisagra',text:'ğŸ”¬ Â¿CuÃ¡l es la diferencia entre una secuencia simple respondiente y una compuesta bifactorial?',opts:['No hay diferencia','La simple es solo ECâ†’RC; la compuesta aÃ±ade que la RC funciona como E interno para una operante ğŸ”—','La simple tiene mÃ¡s pasos','La compuesta no tiene CC'],c:1,ok:'ğŸ¯ Simple: ECâ†’RC (solo CC). Compuesta: ECâ†’RC + RC como Edâ†’ROâ†’Consecuencia (CC+CO unidos por la bisagra).',fail:'ğŸ”‘ Simple = solo CC. Compuesta = CC + CO unidos por la RC/E interno.'}
]},
// ===== NIVEL 5: Descifra el caso =====
{title:'Descifra el caso clÃ­nico',description:'Identifica elementos, fenÃ³menos y secuencias en casos reales â€” algunos con piezas faltantes.',showCount:3,
cheat:['Identificar: EI, EN/EC, RI, RC','Tipo de CC: excitatorio/inhibitorio, apetitivo/aversivo','FenÃ³menos: Â¿hay generalizaciÃ³n? Â¿extinciÃ³n bloqueada?','Secuencia: Â¿simple o compuesta?','La operante: Â¿quÃ© mantiene la evitaciÃ³n? R+? R-?'],
theory:[
{icon:'ğŸ¥',title:'GuÃ­a rÃ¡pida para descifrar un caso',color:'accent',body:'<p>Ante cada caso, sigue estos pasos:</p><div class="ex-box"><div class="ex-box-l">Paso a paso ğŸ”</div><p>1ï¸âƒ£ <b>Â¿CuÃ¡l fue el EI original?</b> Â¿QuÃ© evento incondicionado iniciÃ³ todo?<br><br>2ï¸âƒ£ <b>Â¿QuÃ© era neutro y ahora es EC?</b> Â¿QuÃ© se asociÃ³ con el EI?<br><br>3ï¸âƒ£ <b>Â¿CuÃ¡l es la RC?</b> Â¿QuÃ© respuesta elicita ahora el EC?<br><br>4ï¸âƒ£ <b>Â¿Hay generalizaciÃ³n?</b> Â¿Otros estÃ­mulos similares tambiÃ©n elicitan RC?<br><br>5ï¸âƒ£ <b>Â¿Hay operante asociada?</b> Si sÃ­ â†’ secuencia compuesta. Â¿QuÃ© la mantiene?<br><br>6ï¸âƒ£ <b>Â¿Por quÃ© no se extingue?</b> Â¿La evitaciÃ³n bloquea la extinciÃ³n?</p></div>'}
],
exercises:[
{type:'seq',skill:'caso_cc',patient:{name:'LucÃ­a',age:'28 aÃ±os',gender:'f',initial:'L',badge:'Fobia a volar âœˆï¸'},quote:'"Hace 3 aÃ±os mi aviÃ³n tuvo turbulencias fortÃ­simas. Gritos, mascarillas, pensÃ© que me morÃ­a. Ahora no puedo ni ver un aviÃ³n."',questions:[
{text:'âœˆï¸ Â¿CuÃ¡l fue el EI en la experiencia de LucÃ­a?',opts:['El aviÃ³n','Las turbulencias extremas con amenaza vital (EI aversivo intenso) ğŸ’¥','El miedo','El aeropuerto'],c:1,fb:'ğŸ¯ Las turbulencias extremas = EI aversivo que elicitÃ³ RI (terror, activaciÃ³n mÃ¡xima). Un solo episodio bastÃ³ por la intensidad.'},
{text:'ğŸ¢ LucÃ­a ahora tambiÃ©n siente ansiedad al ver aeropuertos y oÃ­r motores de aviÃ³n. Â¿QuÃ© fenÃ³meno es?',opts:['CC de segundo orden','GeneralizaciÃ³n: estÃ­mulos asociados al vuelo tambiÃ©n elicitan RC ğŸŒŠ','DiscriminaciÃ³n','ExtinciÃ³n'],c:1,fb:'ğŸ¯ GeneralizaciÃ³n: aeropuertos y sonido de motores comparten propiedades con el EC original (vuelo). Â¡La RC se extiende!'},
{text:'ğŸš— LucÃ­a organiza viajes por tierra aunque sean mÃ¡s largos. Â¿Por quÃ© no se extingue su miedo?',opts:['Porque no se puede extinguir','La evitaciÃ³n impide exposiciÃ³n al EC sin EI â†’ no hay oportunidad de extinciÃ³n ğŸ”’','Porque es genÃ©tico','Por los pensamientos'],c:1,fb:'ğŸ¯ Trampa de la evitaciÃ³n: al no volar (evitaciÃ³n mantenida por R-), nunca experimenta vuelos sin turbulencias extremas â†’ no hay extinciÃ³n.'},
{text:'ğŸ”— Â¿Es la secuencia de LucÃ­a simple o compuesta?',opts:['Simple respondiente','Compuesta bifactorial: CC (aviÃ³nâ†’ansiedad) + CO (ansiedadâ†’evitar volarâ†’alivio) ğŸ”—','Solo operante','Ni una ni otra'],c:1,fb:'ğŸ¯ Bifactorial: el CC genera la RC (ansiedad) que funciona como E interno para la operante de evitaciÃ³n (mantenida por R-).'}]},
{type:'seq',skill:'caso_cc',patient:{name:'Diego',age:'8 aÃ±os',gender:'m',initial:'D',badge:'Rechazo alimentario ğŸ½ï¸'},quote:'"ComiÃ³ marisco en una fiesta y vomitÃ³ toda la noche. Ahora rechaza todo tipo de marisco e incluso pescado."',questions:[
{text:'ğŸ¤¢ Â¿CuÃ¡l es el EI y la RI en este caso?',opts:['El marisco es el EI','La intoxicaciÃ³n/malestar gÃ¡strico (EI) â†’ vÃ³mitos/nÃ¡useas (RI) ğŸ¤®','El sabor es el EI','La fiesta es el EI'],c:1,fb:'ğŸ¯ La intoxicaciÃ³n = EI aversivo. VÃ³mitos y nÃ¡useas = RI. El sabor del marisco (EN) se asociÃ³ con el malestar.'},
{text:'ğŸŸ Diego ahora rechaza marisco Y pescado. Â¿QuÃ© fenÃ³meno explica que tambiÃ©n rechace el pescado?',opts:['CC de segundo orden','ExtinciÃ³n','GeneralizaciÃ³n: el pescado comparte propiedades con el marisco (EC) ğŸŒŠ','DiscriminaciÃ³n'],c:2,fb:'ğŸ¯ GeneralizaciÃ³n: pescado es similar al marisco (olor, textura, contexto). Cuanto mÃ¡s parecido al EC, mÃ¡s intensa la RC.'},
{text:'ğŸ’¡ La madre insiste en que pruebe otros pescados. Con el tiempo, Diego come atÃºn sin problemas pero sigue rechazando gambas. Â¿QuÃ© estÃ¡ ocurriendo?',opts:['ExtinciÃ³n total','DiscriminaciÃ³n: aprende a diferenciar entre estÃ­mulos (atÃºn â‰  gambas) ğŸ¯','GeneralizaciÃ³n','Nada relevante'],c:1,fb:'ğŸ¯ DiscriminaciÃ³n: la experiencia repetida de comer atÃºn SIN malestar extingue la RC para atÃºn, pero no para gambas (mÃ¡s parecidas al EC original).'},
{text:'ğŸ“Œ Â¿Es la aversiÃ³n condicionada al sabor un CC tÃ­pico?',opts:['SÃ­, es igual a todos','No: tiene peculiaridades â€” puede establecerse en un solo ensayo y con horas de intervalo entre sabor y malestar âš¡','No es CC','Solo es psicolÃ³gico'],c:1,fb:'ğŸ¯ La aversiÃ³n al sabor es especial: aprendizaje en un ensayo, largo intervalo EC-EI posible. Tiene alto valor adaptativo â€” evita envenenamientos.'}]},
{type:'seq',skill:'caso_cc',patient:{name:'Carmen',age:'45 aÃ±os',gender:'f',initial:'C',badge:'Ansiedad laboral ğŸ’¼'},quote:'"Tuve un jefe que me humillaba en reuniones. Ahora, en mi nuevo trabajo, cada vez que me llaman a una reuniÃ³n siento que me ahogo."',questions:[
{text:'ğŸ—£ï¸ Â¿QuÃ© funcionÃ³ como EI en la historia de Carmen?',opts:['Las reuniones','Las humillaciones pÃºblicas del jefe (EI aversivo social) ğŸ˜¤','La ansiedad','El nuevo trabajo'],c:1,fb:'ğŸ¯ Las humillaciones = EI aversivo (social). Produjeron RI de activaciÃ³n, vergÃ¼enza y malestar intenso.'},
{text:'ğŸ¢ Carmen tiene un nuevo jefe amable, pero sigue con ansiedad en reuniones. Â¿QuÃ© ocurre?',opts:['El nuevo jefe tambiÃ©n la humilla','Las reuniones se convirtieron en EC y siguen elicitando RC aunque el EI (humillaciÃ³n) ya no estÃ¡ presente ğŸ””','Es su personalidad','Es inevitable'],c:1,fb:'ğŸ¯ Las reuniones = EC. Siguen elicitando ansiedad (RC) aunque el contexto cambiÃ³. La asociaciÃ³n original persiste.'},
{text:'ğŸ“‰ Si Carmen asiste a reuniones donde es tratada bien, repetidamente, Â¿quÃ© deberÃ­a ocurrir?',opts:['Nada, el miedo es permanente','ExtinciÃ³n gradual: EC (reuniÃ³n) sin EI (humillaciÃ³n) â†’ RC disminuye ğŸ“‰','Empeoramiento','GeneralizaciÃ³n'],c:1,fb:'ğŸ¯ ExtinciÃ³n: EC repetido sin EI â†’ nuevo aprendizaje â†’ la RC se reduce. Â¡Pero puede haber recuperaciÃ³n espontÃ¡nea!'},
{text:'âš¡ Carmen tambiÃ©n siente ansiedad al recibir emails de cualquier jefe, no solo del que la humillaba. Â¿FenÃ³meno?',opts:['DiscriminaciÃ³n','GeneralizaciÃ³n: estÃ­mulos asociados a la figura de autoridad tambiÃ©n elicitan RC ğŸŒŠ','ExtinciÃ³n','IncubaciÃ³n'],c:1,fb:'ğŸ¯ GeneralizaciÃ³n: "jefe" como clase de estÃ­mulos comparte propiedades con el EC original. La RC se extiende a toda la clase.'}]}
]}
]};

// ========== ENGINE ==========
$a=document.getElementById('app');MOD=MODULE;S.mod='m4';loadP();
function go(v,o){Object.assign(S,o||{},{view:v});if(v==='exercise'){S.answers={};S.seqIdx=0;streak=0;const l=MOD.levels[S.level];S.pool=shuffle([...Array(l.exercises.length).keys()]).slice(0,l.showCount||l.exercises.length);S.exIdx=0}S.tpOpen=false;saveP();render()}
function render(){const v=S.view;if(v==='home')rHome();else if(v==='theory')rTheory();else if(v==='exercise')rEx();else if(v==='gate')rGate();else if(v==='level-sum')rLSum();else if(v==='mod-sum')rMSum();requestAnimationFrame(()=>{const c=$a.querySelector('.cnt');if(c)c.scrollTop=0})}
function getBase(){const p=window.location.pathname;const idx=p.indexOf('/modulo-');return idx!==-1?p.substring(0,idx+1):p.substring(0,p.lastIndexOf('/')+1)}
function topH(t,s,back,prog){let p='';if(prog!==undefined)p=`<div class="top-prog"><div class="top-prog-bar"><div class="top-prog-fill" style="width:${prog}%"></div></div><div class="top-prog-pct">${Math.round(prog)}%</div></div>`;const tb=S.view==='exercise'?`<div class="top-btn" onclick="togTP()" title="TeorÃ­a">${IC.book}</div>`:'';const sk=S.view==='exercise'&&streak>=3?`<span class="streak">ğŸ”¥ Ã—${streak}</span>`:'';return `<div class="top"><div class="top-back" onclick="${back}" tabindex="0">${IC.back}</div><div style="flex:1;min-width:0"><div class="top-t">${t}${sk}</div><div class="top-s">${s}</div></div>${p}<div class="top-acts">${tb}<div class="top-btn" onclick="togDk()">${isDk()?IC.sun:IC.moon}</div></div></div>`}
function tpHTML(){if(!MOD||!MOD.levels[S.level])return '';const l=MOD.levels[S.level];let items='';(l.theory||[]).forEach(t=>{items+=`<div class="acc open"><div class="acc-h" onclick="this.parentElement.classList.toggle('open')"><div class="acc-i" style="background:var(--accent-g)">${t.icon||'ğŸ“–'}</div><div class="acc-l">${t.title}</div><div class="acc-a">â–¼</div></div><div class="acc-b"><div class="acc-in prose">${t.body}</div></div></div>`});return `<div class="tp-overlay${S.tpOpen?' open':''}" onclick="togTP()"></div><div class="tp${S.tpOpen?' open':''}"><button class="tp-close" onclick="togTP()">${IC.x}</button><div class="tag tag-b" style="margin-bottom:12px">ğŸ“– Referencia teÃ³rica</div>${items}</div>`}
function togTP(){S.tpOpen=!S.tpOpen;const p=$a.querySelector('.tp'),o=$a.querySelector('.tp-overlay');if(p)p.classList.toggle('open',S.tpOpen);if(o)o.classList.toggle('open',S.tpOpen)}
function rHome(){const m=MOD;let levels='';m.levels.forEach((l,i)=>{const done=isLD(i),unl=i===0||isLD(i-1),cls=done?'done':(!unl?'locked':'');const sc=P.scores[`l${i}`];let mbar='';if(sc){const p=Math.round((sc.correct/sc.total)*100);mbar=`<div class="lbar"><div class="lbar-f" style="width:${p}%;background:${p>=80?'var(--green)':(p>=50?'var(--gold)':'var(--red)')}"></div></div>`}levels+=`<div class="lcard ${cls}" onclick="${unl?`go('theory',{level:${i}})`:'void(0)'}"><div class="lcard-icon" style="background:${done?'var(--green-g)':`linear-gradient(135deg,${LVL_C[i]},${LVL_C[i]}22)`}">${done?'âœ…':LVL_E[i]}</div><div style="flex:1"><div class="lcard-name">${LVL_N[i]}</div><div class="lcard-sub">${l.title} Â· ${l.exercises.length} ej.</div>${mbar}</div><div class="lcard-arrow">â€º</div></div>`});const tl=m.levels.length;let dl=0;for(let i=0;i<tl;i++)if(isLD(i))dl++;const pct=Math.round((dl/tl)*100);
$a.innerHTML=`${topH(m.phase,m.title,"window.location.href=getBase()+'index.html'")}
<div class="cnt"><div class="anim" style="text-align:center;margin-bottom:16px"><div style="font-size:52px;margin-bottom:8px">${m.icon}</div><div class="card-t" style="font-size:26px">${m.title}</div><div class="card-d" style="max-width:360px;margin:6px auto 0">${m.description}</div></div><div style="display:flex;align-items:center;justify-content:center;gap:20px;margin-bottom:16px" class="anim d1"><div class="ring"><svg width="80" height="80"><circle cx="40" cy="40" r="33" fill="none" stroke="var(--border)" stroke-width="5"/><circle cx="40" cy="40" r="33" fill="none" stroke="var(--gold)" stroke-width="5" stroke-dasharray="${2*Math.PI*33}" stroke-dashoffset="${2*Math.PI*33*(1-pct/100)}" stroke-linecap="round"/></svg><div class="ring-v">${pct}%</div></div><div><div style="border:none;padding:4px 0"><b style="font-family:'Space Mono',monospace;font-size:24px;color:var(--bright);display:block">${dl}/${tl}</b><span style="font-size:11px;color:var(--dim);text-transform:uppercase;letter-spacing:.5px">Niveles</span></div></div></div><div style="font-family:'Space Mono',monospace;font-size:11px;text-transform:uppercase;letter-spacing:1.5px;color:var(--muted);margin:16px 0 8px" class="anim d2">Niveles del mÃ³dulo</div><div class="anim d3">${levels}</div></div>`}
function isLD(i){const sc=P.scores[`l${i}`];return sc&&(sc.correct/sc.total)>=MASTERY}
function rTheory(){const l=MOD.levels[S.level];let acc='';(l.theory||[]).forEach((t,i)=>{acc+=`<div class="acc ${i===0?'open':''}" onclick="this.classList.toggle('open')"><div class="acc-h"><div class="acc-i" style="background:var(--${t.color||'accent'}-g)">${t.icon||'ğŸ“–'}</div><div class="acc-l">${t.title}</div><div class="acc-a">â–¼</div></div><div class="acc-b"><div class="acc-in prose">${t.body}</div></div></div>`});$a.innerHTML=`${topH(`Nivel ${S.level+1}`,l.title,"go('home')")}<div class="cnt"><div class="anim"><div class="card"><div class="tag tag-b">${LVL_E[S.level]} Nivel ${S.level+1} â€” ${LVL_N[S.level]}</div><div class="card-t">${l.title}</div><div class="card-d">${l.description||''}</div></div>${acc}</div></div><div class="bot"><button class="btn btn-p" onclick="go('exercise')">Comenzar ejercicios â€º</button></div>`}
function rEx(){const l=MOD.levels[S.level],pi=S.pool[S.exIdx],ex=l.exercises[pi],total=S.pool.length;let ft=0,fc=0;S.pool.forEach((p,i)=>{const e=l.exercises[p];const c=e.type==='seq'?e.questions.length:(e.type==='classify'?e.items.length:1);if(i<S.exIdx)fc+=c;else if(i===S.exIdx)fc+=S.seqIdx;ft+=c});let pips='<div class="pips">';S.pool.forEach((p,i)=>{const e=l.exercises[p];const c=e.type==='seq'?e.questions.length:(e.type==='classify'?e.items.length:1);for(let s=0;s<c;s++){const k=`${i}-${s}`,a=S.answers[k];let cl=i===S.exIdx&&s===S.seqIdx?'cur':(a===true?'ok':(a===false?'fail':''));pips+=`<div class="pip ${cl}"></div>`}});pips+='</div>';const prog=ft?Math.round(fc/ft*100):0;let body='';if(ex.type==='tf')body=mkTF(ex);else if(ex.type==='single')body=mkSingle(ex);else if(ex.type==='classify')body=mkCl(ex);else if(ex.type==='seq')body=mkSeq(ex);else if(ex.type==='match')body=mkMat(ex);else if(ex.type==='order')body=mkOrder(ex);else if(ex.type==='fill')body=mkFill(ex);$a.innerHTML=`${topH(`Nivel ${S.level+1}`,l.title,"go('home')",prog)}<div class="cnt">${pips}<div id="exW" class="anim">${body}</div></div><div class="bot" id="botB"></div>${tpHTML()}`}
function curK(){return `${S.exIdx}-${S.seqIdx}`}function curE(){return MOD.levels[S.level].exercises[S.pool[S.exIdx]]}
function rec(ok,ex){S.answers[curK()]=ok;if(ok)streak++;else streak=0;if(ex&&ex.skill){if(!P.skills[ex.skill])P.skills[ex.skill]={c:0,t:0};P.skills[ex.skill].t++;if(ok)P.skills[ex.skill].c++}if(!ok&&ex){if(!P.errors[S.level])P.errors[S.level]=[];const q=ex.text||ex.s||(ex.questions?ex.questions[S.seqIdx]?.text:'')||'';const c=typeof ex.c==='number'&&ex.opts?ex.opts[ex.c]:'';P.errors[S.level].push({q:q.substring(0,100),a:(typeof c==='string'?c:'').substring(0,100)})}saveP()}
function showNext(){const b=$('botB');if(b)b.innerHTML=`<button class="btn btn-p" onclick="nextEx()">Siguiente â€º</button>`}
function showFB(ok,t,ex){const f=$('fb');if(!f)return;f.className=`fb show ${ok?'fbok':'fbfail'}`;let extra='';if(ok&&ex&&ex.bonus)extra=`<div class="fb-bonus">ğŸ’¡ ${ex.bonus}</div>`;if(!ok&&ex&&ex.fail&&ex.fail.startsWith('ğŸ”‘'))extra=`<div class="fb-rule">${ex.fail}</div>`;else if(!ok)extra=`<div class="fb-rule">ğŸ”‘ ${t}</div>`;f.innerHTML=`<strong>${ok?'âœ… Â¡Correcto!':'âŒ Incorrecto'}</strong>${ok?t:''}${extra}`;if(!ok){const w=$('exW');if(w){w.classList.add('shake');setTimeout(()=>w.classList.remove('shake'),400)}}}
// === TF ===
function mkTF(ex){return `<div class="card"><div class="q-h"><span class="q-type">âš¡</span><span class="q-tag">V / F</span><span class="q-n">${S.exIdx+1}/${S.pool.length}</span></div><div class="q-text">${ex.s}</div><div class="tf"><div class="tf-b" id="tfV" onclick="chkTF(true)">âœ“ Verdadero</div><div class="tf-b" id="tfF" onclick="chkTF(false)">âœ— Falso</div></div><div class="fb" id="fb"></div></div>`}
function chkTF(v){const ex=curE(),ok=v===ex.c;$('tf'+(v?'V':'F')).classList.add(ok?'ok':'bad','dis');$('tf'+(v?'F':'V')).classList.add('dis');if(!ok)$(ex.c?'tfV':'tfF').classList.add('ok');showFB(ok,ok?ex.ok:ex.fail,ex);rec(ok,ex);showNext()}
// === SINGLE ===
function mkSingle(ex){let o='';ex.opts.forEach((t,i)=>{o+=`<div class="opt" id="so${i}" onclick="chkS(${i})"><div class="opt-m">${String.fromCharCode(65+i)}</div><div class="opt-t">${t}</div></div>`});return `<div class="card"><div class="q-h"><span class="q-type">ğŸ¯</span><span class="q-tag">SelecciÃ³n</span><span class="q-n">${S.exIdx+1}/${S.pool.length}</span></div>${ex.context?`<div class="q-ctx">${ex.context}</div>`:''}<div class="q-text">${ex.text}</div>${o}<div class="fb" id="fb"></div></div>`}
function chkS(i){const ex=curE(),ok=i===ex.c;document.querySelectorAll('.opt').forEach((o,j)=>{o.classList.add('dis');if(j===i)o.classList.add(ok?'ok':'bad');if(j===ex.c&&!ok)o.classList.add('rev')});showFB(ok,ok?ex.ok:ex.fail,ex);rec(ok,ex);showNext()}
// === CLASSIFY ===
function mkCl(ex){const it=ex.items[S.seqIdx];let c='<div class="cl-cats">';ex.categories.forEach(cat=>{c+=`<div class="cl-c" onclick="chkCl(this.dataset.cat)" data-cat="${cat}">${cat}</div>`});c+='</div>';return `<div class="card"><div class="q-h"><span class="q-type">ğŸ“‚</span><span class="q-tag">Clasifica</span><span class="q-n">${S.seqIdx+1}/${ex.items.length}</span></div><div class="q-text">"${it.text}"</div>${c}<div class="fb" id="fb"></div></div>`}
function chkCl(cat){const ex=curE(),it=ex.items[S.seqIdx],ok=cat===it.cat;document.querySelectorAll('.cl-c').forEach(c=>{c.classList.add('dis');if(c.dataset.cat===it.cat)c.classList.add('ok');else if(c.dataset.cat===cat&&!ok)c.classList.add('bad')});showFB(ok,ok?`"${it.text}" â†’ ${it.cat} ğŸ¯`:it.cat,ex);S.answers[curK()]=ok;if(ok)streak++;else{streak=0;if(!P.errors[S.level])P.errors[S.level]=[];P.errors[S.level].push({q:it.text.substring(0,80),a:it.cat})}saveP();setTimeout(()=>{if(S.seqIdx<ex.items.length-1){S.seqIdx++;render()}else{S.seqIdx=0;advEx()}},1400)}
// === SEQ (cases) ===
function mkSeq(ex){const q=ex.questions[S.seqIdx];let o='';q.opts.forEach((t,i)=>{o+=`<div class="opt" id="sq${i}" onclick="chkSq(${i})"><div class="opt-m">${String.fromCharCode(65+i)}</div><div class="opt-t">${t}</div></div>`});let ph='';if(ex.patient){const p=ex.patient;ph=`<div class="pat"><div class="pat-h"><div class="pat-av ${p.gender}">${p.initial}</div><div><div class="pat-name">${p.name}</div><div class="pat-age">${p.age}</div></div><div class="pat-badge">${p.badge}</div></div><div class="pat-q">${ex.quote}</div></div>`}return `${ph}<div class="card"><div class="q-h"><span class="q-type">ğŸ¥</span><span class="q-tag">Caso</span><span class="q-n">${S.seqIdx+1}/${ex.questions.length}</span></div><div class="q-text">${q.text}</div>${o}<div class="fb" id="fb"></div></div>`}
function chkSq(i){const ex=curE(),q=ex.questions[S.seqIdx],ok=i===q.c;document.querySelectorAll('.opt').forEach((o,j)=>{o.classList.add('dis');if(j===i)o.classList.add(ok?'ok':'bad');if(j===q.c&&!ok)o.classList.add('rev')});showFB(ok,q.fb,ex);S.answers[curK()]=ok;if(ok)streak++;else{streak=0;if(!P.errors[S.level])P.errors[S.level]=[];P.errors[S.level].push({q:q.text.substring(0,80),a:q.opts[q.c].substring(0,80)})}saveP();const b=$('botB');if(b){const last=S.seqIdx>=ex.questions.length-1;b.innerHTML=`<button class="btn btn-p" onclick="seqN(${last})">${last?'Siguiente â€º':'Siguiente pregunta â€º'}</button>`}}
function seqN(last){if(last){S.seqIdx=0;advEx()}else{S.seqIdx++;render()}}
// === MATCH ===
let _mL=null,_mC=0;function mkMat(ex){_mL=null;_mC=0;const ls=shuffle(ex.pairs.map((p,i)=>({...p,idx:i}))),rs=shuffle(ex.pairs.map((p,i)=>({...p,idx:i})));let l='<div class="mat-c">';ls.forEach(p=>{l+=`<div class="mat-i" id="ml${p.idx}" onclick="matL(${p.idx})">${p.left}</div>`});l+='</div>';let r='<div class="mat-c">';rs.forEach(p=>{r+=`<div class="mat-i" id="mr${p.idx}" onclick="matR(${p.idx})">${p.right}</div>`});r+='</div>';return `<div class="card"><div class="q-h"><span class="q-type">ğŸ”—</span><span class="q-tag">Empareja</span><span class="q-n">${S.exIdx+1}/${S.pool.length}</span></div><div class="q-text">${ex.text}</div><div class="mat-w">${l}${r}</div><div class="fb" id="fb"></div></div>`}
function matL(i){document.querySelectorAll('.mat-c:first-child .mat-i').forEach(m=>m.classList.remove('sel'));$('ml'+i).classList.add('sel');_mL=i}
function matR(i){if(_mL===null)return;const ok=_mL===i,ml=$('ml'+_mL),mr=$('mr'+i);if(ml)ml.classList.add(ok?'ok':'bad','dis');if(mr)mr.classList.add(ok?'ok':'bad','dis');if(!ok){setTimeout(()=>{if(ml){ml.classList.remove('bad','dis')}if(mr){mr.classList.remove('bad','dis')}},800)}else{_mC++;const ex=curE();if(_mC===ex.pairs.length){showFB(true,ex.ok||'âœ… Todos correctos.',ex);rec(true,ex);showNext()}}_mL=null;document.querySelectorAll('.mat-i').forEach(m=>m.classList.remove('sel'))}
// === ORDER (NEW!) ===
let _ordSeq=[],_ordDone=false;
function mkOrder(ex){_ordSeq=[];_ordDone=false;const shuffled=shuffle(ex.items.map((t,i)=>({t,i})));let bank='<div class="ord-bank">';shuffled.forEach((it,si)=>{bank+=`<div class="ord-item" id="oi${it.i}" onclick="ordPick(${it.i})">${it.t}</div>`});bank+='</div>';let slots='<div class="ord-seq" id="ordSeq"></div>';return `<div class="card"><div class="q-h"><span class="q-type">ğŸ“‹</span><span class="q-tag">Ordena</span><span class="q-n">${S.exIdx+1}/${S.pool.length}</span></div><div class="q-text">${ex.text}</div>${slots}${bank}<div class="fb" id="fb"></div></div>`}
function ordPick(i){if(_ordDone)return;const ex=curE(),step=_ordSeq.length,ok=i===step;const seq=$('ordSeq');const item=$('oi'+i);if(!item||!seq)return;if(ok){item.classList.add('placed');_ordSeq.push(i);seq.innerHTML+=`<div class="ord-slot ok"><div class="ord-num">${step+1}</div>${ex.items[i]}</div>`;if(_ordSeq.length===ex.items.length){_ordDone=true;showFB(true,ex.ok,ex);rec(true,ex);showNext()}}else{item.classList.add('placed');seq.innerHTML+=`<div class="ord-slot bad"><div class="ord-num">âœ—</div>${ex.items[i]}</div>`;_ordDone=true;setTimeout(()=>{seq.innerHTML='';ex.items.forEach((t,j)=>{seq.innerHTML+=`<div class="ord-slot ok"><div class="ord-num">${j+1}</div>${t}</div>`})},1200);showFB(false,ex.fail,ex);rec(false,ex);document.querySelectorAll('.ord-item').forEach(o=>o.classList.add('dis'));showNext()}}
// === FILL (NEW!) ===
let _fillState=[],_fillSel=null,_fillDone=false;
function mkFill(ex){_fillState=new Array(ex.blanks.length).fill(null);_fillSel=null;_fillDone=false;let diag=ex.diagram;ex.blanks.forEach((b,i)=>{diag=diag.replace(`{${i}}`,`<span class="fill-blank" id="fb${i}" onclick="fillBlankClick(${i})">${b.length>3?'___':'___'}</span>`)});const opts=shuffle([...ex.options]);let bank='<div class="fill-bank">';opts.forEach((o,i)=>{bank+=`<div class="fill-opt" id="fo${i}" data-val="${o}" onclick="fillOptClick(${i},'${o.replace(/'/g,"\\'")}')">${o}</div>`});bank+='</div>';return `<div class="card"><div class="q-h"><span class="q-type">ğŸ§©</span><span class="q-tag">Completa</span><span class="q-n">${S.exIdx+1}/${S.pool.length}</span></div><div class="q-text">${ex.text}</div><div class="fill-diag" id="fillDiag">${diag}</div>${bank}<div style="text-align:center;margin-top:8px"><button class="btn btn-p btn-sm" id="fillCheck" onclick="fillCheck()" disabled>Comprobar âœ“</button></div><div class="fb" id="fb"></div></div>`}
function fillOptClick(i,val){if(_fillDone)return;const opt=$('fo'+i);if(!opt||opt.classList.contains('used'))return;const emptyIdx=_fillState.indexOf(null);if(emptyIdx===-1)return;_fillState[emptyIdx]=val;opt.classList.add('used');const blank=$('fb'+emptyIdx);if(blank){blank.textContent=val;blank.classList.add('filled')}if(!_fillState.includes(null)){const cb=$('fillCheck');if(cb)cb.disabled=false}}
function fillBlankClick(i){if(_fillDone||_fillState[i]===null)return;const val=_fillState[i];_fillState[i]=null;const blank=$('fb'+i);if(blank){blank.textContent='___';blank.classList.remove('filled')}document.querySelectorAll('.fill-opt').forEach(o=>{if(o.dataset.val===val&&o.classList.contains('used')){o.classList.remove('used');return}});const cb=$('fillCheck');if(cb)cb.disabled=true}
function fillCheck(){if(_fillDone)return;_fillDone=true;const ex=curE();let allOk=true;ex.blanks.forEach((correct,i)=>{const blank=$('fb'+i);if(_fillState[i]===correct){if(blank)blank.classList.add('ok')}else{allOk=false;if(blank){blank.classList.add('bad');setTimeout(()=>{blank.textContent=correct;blank.classList.remove('bad');blank.classList.add('ok')},1200)}}});document.querySelectorAll('.fill-opt').forEach(o=>o.classList.add('dis'));$('fillCheck').disabled=true;showFB(allOk,allOk?ex.ok:ex.fail,ex);rec(allOk,ex);showNext()}
// === NAV ===
function advEx(){if(S.exIdx<S.pool.length-1){S.exIdx++;S.seqIdx=0;render()}else{let c=0,t=0;for(const[k,v]of Object.entries(S.answers)){if(typeof v==='boolean'){t++;if(v)c++}}P.scores[`l${S.level}`]={correct:c,total:t};saveP();const p=t?c/t:0;if(p>=MASTERY){fireConfetti();go('level-sum')}else{go('gate')}}}
function nextEx(){const ex=curE();if(ex.type==='classify'||ex.type==='seq')return;advEx()}
function rGate(){const sc=P.scores[`l${S.level}`],pct=sc?Math.round((sc.correct/sc.total)*100):0,need=Math.ceil(sc.total*MASTERY);let errs='';const el=P.errors[S.level]||[];const seen=new Set;el.forEach(e=>{if(!seen.has(e.q)&&seen.size<5){seen.add(e.q);errs+=`<div class="rev"><div class="rev-q">${e.q}</div><div class="rev-a">âœ“ ${e.a}</div></div>`}});$a.innerHTML=`${topH(`Nivel ${S.level+1}`,MOD.levels[S.level].title,"go('home')")}<div class="cnt"><div class="gate anim"><div class="gate-ic">ğŸ”’</div><div class="gate-t">Criterio no alcanzado</div><div class="gate-d">Necesitas <strong>â‰¥80%</strong> (${need}/${sc.total}) para avanzar. Obtuviste ${sc.correct}/${sc.total}.</div><div class="gate-bar"><div class="gate-bar-f" style="width:${pct}%;background:${pct>=80?'var(--green)':(pct>=50?'var(--gold)':'var(--red)')}"></div></div><div class="gate-sc" style="color:${pct>=50?'var(--gold)':'var(--red)'}">${pct}%</div>${errs?'<div style="font-family:\'Space Mono\',monospace;font-size:11px;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin:12px 0 6px">ğŸ“ Revisar</div>'+errs:''}</div></div><div class="bot"><button class="btn btn-o" onclick="go('home')">â† MÃ³dulo</button><button class="btn btn-w" onclick="retryLvl()">ğŸ”„ Reintentar</button></div>`}
function retryLvl(){delete P.scores[`l${S.level}`];P.errors[S.level]=[];saveP();go('exercise')}
function rLSum(){const sc=P.scores[`l${S.level}`],pct=sc?Math.round((sc.correct/sc.total)*100):0,cls=pct>=80?'great':(pct>=50?'mid':'low');const l=MOD.levels[S.level],hasN=S.level<MOD.levels.length-1;let sk=renderSk(),er=renderEr(),ch='';if(l.cheat){ch=`<div class="cheat"><div class="cheat-t">ğŸ“‹ Conceptos clave</div>`;l.cheat.forEach(c=>{ch+=`<div class="cheat-i">â€¢ ${c}</div>`});ch+='</div>'}$a.innerHTML=`${topH(`Nivel ${S.level+1}`,'Resultados',"go('home')")}<div class="cnt" style="text-align:center"><div class="anim"><div class="sum-c ${cls}"><div class="sum-n">${sc.correct}</div><div class="sum-t">de ${sc.total}</div></div><div class="sum-msg">${pct>=90?'ğŸŒŸ Â¡Excelente!':(pct>=80?'âœ… Â¡Nivel superado!':'ğŸ’ª Buen progreso')}</div><div class="sum-sub">${LVL_N[S.level]}: ${l.title} â€” ${pct}%</div></div><div style="text-align:left" class="anim d1">${sk}</div><div style="text-align:left" class="anim d2">${er}</div><div style="text-align:left" class="anim d3">${ch}</div></div><div class="bot"><button class="btn btn-icon btn-o" onclick="retryLvl()">${IC.refresh}</button>${hasN?`<button class="btn btn-p" onclick="go('theory',{level:${S.level+1}})">Nivel ${S.level+2} â€º</button>`:`<button class="btn btn-g" onclick="go('mod-sum')">Resumen â€º</button>`}</div>`}
function rMSum(){let tc=0,tt=0,rows='';MOD.levels.forEach((l,i)=>{const sc=P.scores[`l${i}`];if(sc){tc+=sc.correct;tt+=sc.total;const p=Math.round((sc.correct/sc.total)*100);rows+=`<div style="display:flex;align-items:center;gap:8px;padding:8px 0;border-bottom:1px solid var(--border2)"><span style="font-size:16px">${p>=80?'âœ…':(p>=50?'ğŸŸ¡':'ğŸ”´')}</span><span style="flex:1;font-size:14px">${LVL_N[i]}: ${l.title}</span><span style="font-family:'Space Mono',monospace;font-size:13px;font-weight:700;color:${p>=80?'var(--green)':(p>=50?'var(--gold)':'var(--red)')}">${p}%</span></div>`}});const pct=tt?Math.round((tc/tt)*100):0;$a.innerHTML=`${topH(MOD.phase,MOD.title,"go('home')")}<div class="cnt" style="text-align:center"><div class="anim"><div style="font-size:48px;margin-bottom:6px">${pct>=80?'ğŸ‰':'ğŸ’ª'}</div><div class="sum-c ${pct>=80?'great':(pct>=50?'mid':'low')}"><div class="sum-n">${tc}</div><div class="sum-t">de ${tt}</div></div><div class="sum-msg">${pct>=80?'Â¡MÃ³dulo completado!':'Sigue practicando'}</div><div class="sum-sub">${MOD.title} â€” ${pct}%</div></div><div class="card anim d1" style="text-align:left">${rows}</div><div style="text-align:left" class="anim d2">${renderSk()}</div></div><div class="bot"><button class="btn btn-o" onclick="window.location.href=getBase()+'index.html'">â† Plataforma</button></div>`}
function renderSk(){const sk=P.skills,ks=Object.keys(sk);if(!ks.length)return '';let h='<div style="font-family:\'Space Mono\',monospace;font-size:11px;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin:12px 0 6px">ğŸ“Š Habilidades</div><div class="sk-grid">';ks.forEach(k=>{const s=sk[k],p=s.t?Math.round((s.c/s.t)*100):0,c=p>=80?'var(--green)':(p>=50?'var(--gold)':'var(--red)');h+=`<div class="sk-r"><span class="sk-name">${k.replace(/_/g,' ').replace(/\b\w/g,l=>l.toUpperCase())}</span><div class="sk-bar"><div class="sk-bar-f" style="width:${p}%;background:${c}"></div></div><span class="sk-pct" style="color:${c}">${p}%</span></div>`});return h+'</div>'}
function renderEr(){const e=P.errors[S.level];if(!e||!e.length)return '';let h='<div style="font-family:\'Space Mono\',monospace;font-size:11px;text-transform:uppercase;letter-spacing:1px;color:var(--muted);margin:12px 0 6px">âŒ Revisar</div>';const seen=new Set;e.forEach(x=>{if(!seen.has(x.q)&&seen.size<6){seen.add(x.q);h+=`<div class="rev"><div class="rev-q">${x.q}</div><div class="rev-a">âœ“ ${x.a}</div></div>`}});return h}
render();
</script>
</body>
</html>
